/*
 * Decompiled with CFR 0_132.
 */
package com.itextpdf.text.pdf;

import com.itextpdf.text.BaseColor;
import com.itextpdf.text.error_messages.MessageLocalization;
import com.itextpdf.text.pdf.CMYKColor;
import com.itextpdf.text.pdf.ICachedColorSpace;
import com.itextpdf.text.pdf.LabColor;
import com.itextpdf.text.pdf.PdfArray;
import com.itextpdf.text.pdf.PdfDictionary;
import com.itextpdf.text.pdf.PdfName;
import com.itextpdf.text.pdf.PdfObject;
import com.itextpdf.text.pdf.PdfWriter;
import java.util.Arrays;

public class PdfLabColor
implements ICachedColorSpace {
    float[] blackPoint = null;
    float[] range = null;
    float[] whitePoint = new float[]{0.9505f, 1.0f, 1.089f};

    public PdfLabColor() {
    }

    public PdfLabColor(float[] arrf) {
        if (arrf != null && arrf.length == 3 && arrf[0] >= 1.0E-6f && arrf[2] >= 1.0E-6f && arrf[1] >= 0.999999f && arrf[1] <= 1.000001f) {
            this.whitePoint = arrf;
            return;
        }
        throw new RuntimeException(MessageLocalization.getComposedMessage("lab.cs.white.point", new Object[0]));
    }

    public PdfLabColor(float[] arrf, float[] arrf2) {
        this(arrf);
        this.blackPoint = arrf2;
    }

    public PdfLabColor(float[] arrf, float[] arrf2, float[] arrf3) {
        this(arrf, arrf2);
        this.range = arrf3;
    }

    private static double fXyz(double d) {
        if (d > 0.008856) {
            return Math.pow(d, 0.3333333333333333);
        }
        return d * 7.787 + 0.13793103448275862;
    }

    @Override
    public boolean equals(Object object) {
        if (this == object) {
            return true;
        }
        if (!(object instanceof PdfLabColor)) {
            return false;
        }
        object = (PdfLabColor)object;
        if (!Arrays.equals(this.blackPoint, object.blackPoint)) {
            return false;
        }
        if (!Arrays.equals(this.range, object.range)) {
            return false;
        }
        if (!Arrays.equals(this.whitePoint, object.whitePoint)) {
            return false;
        }
        return true;
    }

    @Override
    public PdfObject getPdfObject(PdfWriter object) {
        object = new PdfArray(PdfName.LAB);
        PdfDictionary pdfDictionary = new PdfDictionary();
        if (this.whitePoint != null && this.whitePoint.length == 3 && this.whitePoint[0] >= 1.0E-6f && this.whitePoint[2] >= 1.0E-6f && this.whitePoint[1] >= 0.999999f && this.whitePoint[1] <= 1.000001f) {
            pdfDictionary.put(PdfName.WHITEPOINT, new PdfArray(this.whitePoint));
            if (this.blackPoint != null) {
                if (this.blackPoint.length == 3 && this.blackPoint[0] >= -1.0E-6f && this.blackPoint[1] >= -1.0E-6f && this.blackPoint[2] >= -1.0E-6f) {
                    pdfDictionary.put(PdfName.BLACKPOINT, new PdfArray(this.blackPoint));
                } else {
                    throw new RuntimeException(MessageLocalization.getComposedMessage("lab.cs.black.point", new Object[0]));
                }
            }
            if (this.range != null) {
                if (this.range.length == 4 && this.range[0] <= this.range[1] && this.range[2] <= this.range[3]) {
                    pdfDictionary.put(PdfName.RANGE, new PdfArray(this.range));
                } else {
                    throw new RuntimeException(MessageLocalization.getComposedMessage("lab.cs.range", new Object[0]));
                }
            }
            object.add(pdfDictionary);
            return object;
        }
        throw new RuntimeException(MessageLocalization.getComposedMessage("lab.cs.white.point", new Object[0]));
    }

    @Override
    public int hashCode() {
        int n = Arrays.hashCode(this.whitePoint);
        float[] arrf = this.blackPoint;
        int n2 = 0;
        int n3 = arrf != null ? Arrays.hashCode(this.blackPoint) : 0;
        if (this.range != null) {
            n2 = Arrays.hashCode(this.range);
        }
        return (n * 31 + n3) * 31 + n2;
    }

    CMYKColor lab2Cmyk(float f, float f2, float f3) {
        double[] arrd = this.lab2RgbLinear(f, f2, f3);
        double d = arrd[0];
        double d2 = arrd[1];
        double d3 = arrd[2];
        double d4 = 0.0;
        if (d == 0.0 && d2 == 0.0 && f3 == 0.0f) {
            d2 = d = 0.0;
            d3 = 1.0;
        } else {
            d = 1.0 - d;
            d2 = 1.0 - d2;
            double d5 = 1.0 - d3;
            d3 = Math.min(d, Math.min(d2, d5));
            double d6 = 1.0 - d3;
            d4 = (d - d3) / d6;
            d = (d2 - d3) / d6;
            d2 = (d5 - d3) / d6;
        }
        return new CMYKColor((float)d4, (float)d, (float)d2, (float)d3);
    }

    public BaseColor lab2Rgb(float f, float f2, float f3) {
        double[] arrd = this.lab2RgbLinear(f, f2, f3);
        return new BaseColor((float)arrd[0], (float)arrd[1], (float)arrd[2]);
    }

    protected double[] lab2RgbLinear(float f, float f2, float f3) {
        float f4;
        float[] arrf = this.range;
        int n = 0;
        if (arrf != null && this.range.length == 4) {
            float f5 = f2 < this.range[0] ? this.range[0] : f2;
            f2 = f5;
            if (f5 > this.range[1]) {
                f2 = this.range[1];
            }
            f5 = f3 < this.range[2] ? this.range[2] : f3;
            f4 = f2;
            f3 = f5;
            if (f5 > this.range[3]) {
                f3 = this.range[3];
                f4 = f2;
            }
        } else {
            f4 = f2;
        }
        double d = (double)(f + 16.0f) / 116.0;
        double d2 = (double)f4 / 500.0 + d;
        double d3 = d - (double)f3 / 200.0;
        d2 = d2 > 0.20689655172413793 ? (double)this.whitePoint[0] * (d2 * d2 * d2) : (d2 - 0.13793103448275862) * 3.0 * 0.04280618311533888 * (double)this.whitePoint[0];
        d = d > 0.20689655172413793 ? (double)this.whitePoint[1] * (d * d * d) : (double)this.whitePoint[1] * ((d - 0.13793103448275862) * 3.0 * 0.04280618311533888);
        d3 = d3 > 0.20689655172413793 ? (double)this.whitePoint[2] * (d3 * d3 * d3) : (double)this.whitePoint[2] * ((d3 - 0.13793103448275862) * 3.0 * 0.04280618311533888);
        arrf = new double[]{(float)(3.241 * d2 - 1.5374 * d - 0.4986 * d3), (float)((- d2) * 0.9692 + 1.876 * d - 0.0416 * d3), (float)(d2 * 0.0556 - d * 0.204 + d3 * 1.057)};
        while (n < 3) {
            d2 = arrf[n] <= 0.0031308 ? (double)(arrf[n] * 12.92) : Math.pow(arrf[n], 0.4166666666666667) * 1.055 - 0.055;
            arrf[n] = (float)d2;
            if (arrf[n] < 0.0) {
                arrf[n] = (float)0.0;
            } else if (arrf[n] > 1.0) {
                arrf[n] = (float)1.0;
            }
            ++n;
        }
        return arrf;
    }

    public LabColor rgb2lab(BaseColor baseColor) {
        double d = (float)baseColor.getRed() / 255.0f;
        double d2 = (float)baseColor.getGreen() / 255.0f;
        double d3 = (float)baseColor.getBlue() / 255.0f;
        d = d > 0.04045 ? Math.pow((d + 0.055) / 1.055, 2.2) : (d /= 12.92);
        d2 = d2 > 0.04045 ? Math.pow((d2 + 0.055) / 1.055, 2.2) : (d2 /= 12.92);
        d3 = d3 > 0.04045 ? Math.pow((d3 + 0.055) / 1.055, 2.2) : (d3 /= 12.92);
        double d4 = 0.2126 * d + 0.7152 * d2 + 0.0722 * d3;
        return new LabColor(this, (float)Math.round((PdfLabColor.fXyz(d4 / (double)this.whitePoint[1]) * 116.0 - 16.0) * 1000.0) / 1000.0f, (float)Math.round((PdfLabColor.fXyz((0.4124 * d + 0.3576 * d2 + 0.1805 * d3) / (double)this.whitePoint[0]) - PdfLabColor.fXyz(d4 / (double)this.whitePoint[1])) * 500.0 * 1000.0) / 1000.0f, (float)Math.round((PdfLabColor.fXyz(d4 / (double)this.whitePoint[1]) - PdfLabColor.fXyz((d * 0.0193 + d2 * 0.1192 + d3 * 0.9505) / (double)this.whitePoint[2])) * 200.0 * 1000.0) / 1000.0f);
    }
}

