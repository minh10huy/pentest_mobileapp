/*
 * Decompiled with CFR 0_132.
 */
package com.itextpdf.text.pdf;

import com.itextpdf.text.error_messages.MessageLocalization;
import com.itextpdf.text.pdf.RandomAccessFileOrArray;
import java.io.IOException;
import java.io.OutputStream;
import java.io.OutputStreamWriter;
import java.io.PrintWriter;
import java.io.Writer;

public final class Pfm2afm {
    private int[] Win2PSStd = new int[]{0, 0, 0, 0, 197, 198, 199, 0, 202, 0, 205, 206, 207, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 32, 33, 34, 35, 36, 37, 38, 169, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 193, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 0, 184, 166, 185, 188, 178, 179, 195, 189, 0, 172, 234, 0, 0, 0, 0, 96, 0, 170, 186, 183, 177, 208, 196, 0, 0, 173, 250, 0, 0, 0, 0, 161, 162, 163, 168, 165, 0, 167, 200, 0, 227, 171, 0, 0, 0, 197, 0, 0, 0, 0, 194, 0, 182, 180, 203, 0, 235, 187, 0, 0, 0, 191, 0, 0, 0, 0, 0, 0, 225, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 233, 0, 0, 0, 0, 0, 0, 251, 0, 0, 0, 0, 0, 0, 241, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 249, 0, 0, 0, 0, 0, 0, 0};
    private String[] WinChars = new String[]{"W00", "W01", "W02", "W03", "macron", "breve", "dotaccent", "W07", "ring", "W09", "W0a", "W0b", "W0c", "W0d", "W0e", "W0f", "hungarumlaut", "ogonek", "caron", "W13", "W14", "W15", "W16", "W17", "W18", "W19", "W1a", "W1b", "W1c", "W1d", "W1e", "W1f", "space", "exclam", "quotedbl", "numbersign", "dollar", "percent", "ampersand", "quotesingle", "parenleft", "parenright", "asterisk", "plus", "comma", "hyphen", "period", "slash", "zero", "one", "two", "three", "four", "five", "six", "seven", "eight", "nine", "colon", "semicolon", "less", "equal", "greater", "question", "at", "A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z", "bracketleft", "backslash", "bracketright", "asciicircum", "underscore", "grave", "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", "braceleft", "bar", "braceright", "asciitilde", "W7f", "euro", "W81", "quotesinglbase", "florin", "quotedblbase", "ellipsis", "dagger", "daggerdbl", "circumflex", "perthousand", "Scaron", "guilsinglleft", "OE", "W8d", "Zcaron", "W8f", "W90", "quoteleft", "quoteright", "quotedblleft", "quotedblright", "bullet", "endash", "emdash", "tilde", "trademark", "scaron", "guilsinglright", "oe", "W9d", "zcaron", "Ydieresis", "reqspace", "exclamdown", "cent", "sterling", "currency", "yen", "brokenbar", "section", "dieresis", "copyright", "ordfeminine", "guillemotleft", "logicalnot", "syllable", "registered", "macron", "degree", "plusminus", "twosuperior", "threesuperior", "acute", "mu", "paragraph", "periodcentered", "cedilla", "onesuperior", "ordmasculine", "guillemotright", "onequarter", "onehalf", "threequarters", "questiondown", "Agrave", "Aacute", "Acircumflex", "Atilde", "Adieresis", "Aring", "AE", "Ccedilla", "Egrave", "Eacute", "Ecircumflex", "Edieresis", "Igrave", "Iacute", "Icircumflex", "Idieresis", "Eth", "Ntilde", "Ograve", "Oacute", "Ocircumflex", "Otilde", "Odieresis", "multiply", "Oslash", "Ugrave", "Uacute", "Ucircumflex", "Udieresis", "Yacute", "Thorn", "germandbls", "agrave", "aacute", "acircumflex", "atilde", "adieresis", "aring", "ae", "ccedilla", "egrave", "eacute", "ecircumflex", "edieresis", "igrave", "iacute", "icircumflex", "idieresis", "eth", "ntilde", "ograve", "oacute", "ocircumflex", "otilde", "odieresis", "divide", "oslash", "ugrave", "uacute", "ucircumflex", "udieresis", "yacute", "thorn", "ydieresis"};
    private int[] WinClass = new int[]{0, 0, 0, 0, 2, 2, 2, 0, 2, 0, 2, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 0, 0, 2, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 0, 0, 0, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 0, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1};
    private short ascender;
    private short ascent;
    private short avgwidth;
    private int bitoff;
    private int bits;
    private byte brkchar;
    private short capheight;
    private byte charset;
    private int chartab;
    private String copyright;
    private byte defchar;
    private short descender;
    private int device;
    private short extleading;
    private short extlen;
    private int face;
    private int firstchar;
    private int fontname;
    private int h_len;
    private short horres;
    private RandomAccessFileOrArray in;
    private short intleading;
    private boolean isMono;
    private byte italic;
    private int kernpairs;
    private byte kind;
    private int lastchar;
    private short maxwidth;
    private PrintWriter out;
    private byte overs;
    private short pixheight;
    private short pixwidth;
    private short points;
    private int psext;
    private int res1;
    private int res2;
    private short type;
    private byte uline;
    private short verres;
    private short vers;
    private short weight;
    private short widthby;
    private short xheight;

    private Pfm2afm(RandomAccessFileOrArray randomAccessFileOrArray, OutputStream outputStream) throws IOException {
        this.in = randomAccessFileOrArray;
        this.out = new PrintWriter(new OutputStreamWriter(outputStream, "ISO-8859-1"));
    }

    public static void convert(RandomAccessFileOrArray object, OutputStream outputStream) throws IOException {
        object = new Pfm2afm((RandomAccessFileOrArray)object, outputStream);
        Pfm2afm.super.openpfm();
        Pfm2afm.super.putheader();
        Pfm2afm.super.putchartab();
        Pfm2afm.super.putkerntab();
        Pfm2afm.super.puttrailer();
        object.out.flush();
    }

    private void openpfm() throws IOException {
        this.in.seek(0L);
        this.vers = this.in.readShortLE();
        this.h_len = this.in.readIntLE();
        this.copyright = this.readString(60);
        this.type = this.in.readShortLE();
        this.points = this.in.readShortLE();
        this.verres = this.in.readShortLE();
        this.horres = this.in.readShortLE();
        this.ascent = this.in.readShortLE();
        this.intleading = this.in.readShortLE();
        this.extleading = this.in.readShortLE();
        this.italic = (byte)this.in.read();
        this.uline = (byte)this.in.read();
        this.overs = (byte)this.in.read();
        this.weight = this.in.readShortLE();
        this.charset = (byte)this.in.read();
        this.pixwidth = this.in.readShortLE();
        this.pixheight = this.in.readShortLE();
        this.kind = (byte)this.in.read();
        this.avgwidth = this.in.readShortLE();
        this.maxwidth = this.in.readShortLE();
        this.firstchar = this.in.read();
        this.lastchar = this.in.read();
        this.defchar = (byte)this.in.read();
        this.brkchar = (byte)this.in.read();
        this.widthby = this.in.readShortLE();
        this.device = this.in.readIntLE();
        this.face = this.in.readIntLE();
        this.bits = this.in.readIntLE();
        this.bitoff = this.in.readIntLE();
        this.extlen = this.in.readShortLE();
        this.psext = this.in.readIntLE();
        this.chartab = this.in.readIntLE();
        this.res1 = this.in.readIntLE();
        this.kernpairs = this.in.readIntLE();
        this.res2 = this.in.readIntLE();
        this.fontname = this.in.readIntLE();
        if ((long)this.h_len == this.in.length() && this.extlen == 30 && this.fontname >= 75 && this.fontname <= 512) {
            this.in.seek(this.psext + 14);
            this.capheight = this.in.readShortLE();
            this.xheight = this.in.readShortLE();
            this.ascender = this.in.readShortLE();
            this.descender = this.in.readShortLE();
            return;
        }
        throw new IOException(MessageLocalization.getComposedMessage("not.a.valid.pfm.file", new Object[0]));
    }

    private void outchar(int n, int n2, String string2) {
        this.out.print("C ");
        this.outval(n);
        this.out.print(" ; WX ");
        this.outval(n2);
        if (string2 != null) {
            this.out.print(" ; N ");
            this.out.print(string2);
        }
        this.out.print(" ;\n");
    }

    private void outval(int n) {
        this.out.print(' ');
        this.out.print(n);
    }

    private void putchartab() throws IOException {
        int n;
        int n2 = this.lastchar - this.firstchar + 1;
        int[] arrn = new int[n2];
        this.in.seek(this.chartab);
        for (n = 0; n < n2; ++n) {
            arrn[n] = this.in.readUnsignedShortLE();
        }
        int[] arrn2 = new int[256];
        if (this.charset == 0) {
            for (n = this.firstchar; n <= this.lastchar; ++n) {
                if (this.Win2PSStd[n] == 0) continue;
                arrn2[this.Win2PSStd[n]] = n;
            }
        }
        this.out.print("StartCharMetrics");
        this.outval(n2);
        this.out.print('\n');
        if (this.charset != 0) {
            for (n = this.firstchar; n <= this.lastchar; ++n) {
                if (arrn[n - this.firstchar] == 0) continue;
                this.outchar(n, arrn[n - this.firstchar], null);
            }
        } else {
            for (n = 0; n < 256; ++n) {
                n2 = arrn2[n];
                if (n2 == 0) continue;
                this.outchar(n, arrn[n2 - this.firstchar], this.WinChars[n2]);
                arrn[n2 - this.firstchar] = 0;
            }
            for (n = this.firstchar; n <= this.lastchar; ++n) {
                if (arrn[n - this.firstchar] == 0) continue;
                this.outchar(-1, arrn[n - this.firstchar], this.WinChars[n]);
            }
        }
        this.out.print("EndCharMetrics\n");
    }

    private void putheader() throws IOException {
        Appendable appendable;
        Object object;
        this.out.print("StartFontMetrics 2.0\n");
        if (this.copyright.length() > 0) {
            object = this.out;
            appendable = new StringBuilder();
            appendable.append("Comment ");
            appendable.append(this.copyright);
            appendable.append('\n');
            object.print(appendable.toString());
        }
        this.out.print("FontName ");
        this.in.seek(this.fontname);
        object = this.readString();
        this.out.print((String)object);
        this.out.print("\nEncodingScheme ");
        if (this.charset != 0) {
            this.out.print("FontSpecific\n");
        } else {
            this.out.print("AdobeStandardEncoding\n");
        }
        appendable = this.out;
        StringBuilder stringBuilder = new StringBuilder();
        stringBuilder.append("FullName ");
        stringBuilder.append(object.replace('-', ' '));
        appendable.print(stringBuilder.toString());
        if (this.face != 0) {
            this.in.seek(this.face);
            appendable = this.out;
            stringBuilder = new StringBuilder();
            stringBuilder.append("\nFamilyName ");
            stringBuilder.append(this.readString());
            appendable.print(stringBuilder.toString());
        }
        this.out.print("\nWeight ");
        if (this.weight <= 475 && object.toLowerCase().indexOf("bold") < 0) {
            if (this.weight < 325 && this.weight != 0 || object.toLowerCase().indexOf("light") >= 0) {
                this.out.print("Light");
            } else if (object.toLowerCase().indexOf("black") >= 0) {
                this.out.print("Black");
            } else {
                this.out.print("Medium");
            }
        } else {
            this.out.print("Bold");
        }
        this.out.print("\nItalicAngle ");
        if (this.italic == 0 && object.toLowerCase().indexOf("italic") < 0) {
            this.out.print("0");
        } else {
            this.out.print("-12.00");
        }
        this.out.print("\nIsFixedPitch ");
        if ((this.kind & 1) != 0 && this.avgwidth != this.maxwidth) {
            this.out.print("false");
            this.isMono = false;
        } else {
            this.out.print("true");
            this.isMono = true;
        }
        this.out.print("\nFontBBox");
        if (this.isMono) {
            this.outval(-20);
        } else {
            this.outval(-100);
        }
        this.outval(- this.descender + 5);
        this.outval(this.maxwidth + 10);
        this.outval(this.ascent + 5);
        this.out.print("\nCapHeight");
        this.outval(this.capheight);
        this.out.print("\nXHeight");
        this.outval(this.xheight);
        this.out.print("\nDescender");
        this.outval(- this.descender);
        this.out.print("\nAscender");
        this.outval(this.ascender);
        this.out.print('\n');
    }

    private void putkerntab() throws IOException {
        int n;
        if (this.kernpairs == 0) {
            return;
        }
        this.in.seek(this.kernpairs);
        int[] arrn = new int[this.in.readUnsignedShortLE() * 3];
        int n2 = 0;
        int n3 = 0;
        for (int i = 0; i < arrn.length; ++i) {
            n = i + 1;
            arrn[i] = this.in.read();
            i = n + 1;
            arrn[n] = this.in.read();
            short s = this.in.readShortLE();
            arrn[i] = s;
            n = n3;
            if (s != 0) {
                n = n3 + 1;
            }
            n3 = n;
        }
        if (n3 == 0) {
            return;
        }
        this.out.print("StartKernData\nStartKernPairs");
        this.outval(n3);
        this.out.print('\n');
        for (n3 = n2; n3 < arrn.length; n3 += 3) {
            n = n3 + 2;
            if (arrn[n] == 0) continue;
            this.out.print("KPX ");
            this.out.print(this.WinChars[arrn[n3]]);
            this.out.print(' ');
            this.out.print(this.WinChars[arrn[n3 + 1]]);
            this.outval(arrn[n]);
            this.out.print('\n');
        }
        this.out.print("EndKernPairs\nEndKernData\n");
    }

    private void puttrailer() {
        this.out.print("EndFontMetrics\n");
    }

    private String readString() throws IOException {
        StringBuffer stringBuffer = new StringBuffer();
        int n;
        while ((n = this.in.read()) > 0) {
            stringBuffer.append((char)n);
        }
        return stringBuffer.toString();
    }

    private String readString(int n) throws IOException {
        byte[] arrby = new byte[n];
        this.in.readFully(arrby);
        for (n = 0; n < arrby.length && arrby[n] != 0; ++n) {
        }
        return new String(arrby, 0, n, "ISO-8859-1");
    }
}

