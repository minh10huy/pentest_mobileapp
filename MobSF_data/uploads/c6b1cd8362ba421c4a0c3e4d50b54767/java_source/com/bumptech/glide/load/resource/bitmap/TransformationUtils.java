/*
 * Decompiled with CFR 0_132.
 * 
 * Could not load the following classes:
 *  android.annotation.TargetApi
 *  android.graphics.Bitmap
 *  android.graphics.Bitmap$Config
 *  android.graphics.Canvas
 *  android.graphics.Matrix
 *  android.graphics.Paint
 *  android.graphics.RectF
 *  android.media.ExifInterface
 *  android.os.Build
 *  android.os.Build$VERSION
 *  android.util.Log
 */
package com.bumptech.glide.load.resource.bitmap;

import android.annotation.TargetApi;
import android.graphics.Bitmap;
import android.graphics.Canvas;
import android.graphics.Matrix;
import android.graphics.Paint;
import android.graphics.RectF;
import android.media.ExifInterface;
import android.os.Build;
import android.util.Log;
import com.bumptech.glide.load.engine.bitmap_recycle.BitmapPool;

public final class TransformationUtils {
    public static final int PAINT_FLAGS = 6;
    private static final String TAG = "TransformationUtils";

    private TransformationUtils() {
    }

    public static Bitmap centerCrop(Bitmap bitmap, Bitmap bitmap2, int n, int n2) {
        float f;
        float f2;
        if (bitmap2 == null) {
            return null;
        }
        if (bitmap2.getWidth() == n && bitmap2.getHeight() == n2) {
            return bitmap2;
        }
        Matrix matrix = new Matrix();
        int n3 = bitmap2.getWidth();
        int n4 = bitmap2.getHeight();
        float f3 = 0.0f;
        if (n3 * n2 > n4 * n) {
            f2 = (float)n2 / (float)bitmap2.getHeight();
            f = ((float)n - (float)bitmap2.getWidth() * f2) * 0.5f;
        } else {
            f2 = (float)n / (float)bitmap2.getWidth();
            f3 = ((float)n2 - (float)bitmap2.getHeight() * f2) * 0.5f;
            f = 0.0f;
        }
        matrix.setScale(f2, f2);
        matrix.postTranslate((float)((int)(f + 0.5f)), (float)((int)(f3 + 0.5f)));
        if (bitmap == null) {
            bitmap = Bitmap.createBitmap((int)n, (int)n2, (Bitmap.Config)TransformationUtils.getSafeConfig(bitmap2));
        }
        TransformationUtils.setAlpha(bitmap2, bitmap);
        new Canvas(bitmap).drawBitmap(bitmap2, matrix, new Paint(6));
        return bitmap;
    }

    public static Bitmap fitCenter(Bitmap bitmap, BitmapPool bitmapPool, int n, int n2) {
        if (bitmap.getWidth() == n && bitmap.getHeight() == n2) {
            if (Log.isLoggable((String)TAG, (int)2)) {
                Log.v((String)TAG, (String)"requested target size matches input, returning input");
            }
            return bitmap;
        }
        float f = Math.min((float)n / (float)bitmap.getWidth(), (float)n2 / (float)bitmap.getHeight());
        int n3 = (int)((float)bitmap.getWidth() * f);
        int n4 = (int)((float)bitmap.getHeight() * f);
        if (bitmap.getWidth() == n3 && bitmap.getHeight() == n4) {
            if (Log.isLoggable((String)TAG, (int)2)) {
                Log.v((String)TAG, (String)"adjusted target size matches input, returning input");
            }
            return bitmap;
        }
        Bitmap.Config config = TransformationUtils.getSafeConfig(bitmap);
        Object object = bitmapPool.get(n3, n4, config);
        bitmapPool = object;
        if (object == null) {
            bitmapPool = Bitmap.createBitmap((int)n3, (int)n4, (Bitmap.Config)config);
        }
        TransformationUtils.setAlpha(bitmap, (Bitmap)bitmapPool);
        if (Log.isLoggable((String)TAG, (int)2)) {
            object = new StringBuilder();
            object.append("request: ");
            object.append(n);
            object.append("x");
            object.append(n2);
            Log.v((String)TAG, (String)object.toString());
            object = new StringBuilder();
            object.append("toFit:   ");
            object.append(bitmap.getWidth());
            object.append("x");
            object.append(bitmap.getHeight());
            Log.v((String)TAG, (String)object.toString());
            object = new StringBuilder();
            object.append("toReuse: ");
            object.append(bitmapPool.getWidth());
            object.append("x");
            object.append(bitmapPool.getHeight());
            Log.v((String)TAG, (String)object.toString());
            object = new StringBuilder();
            object.append("minPct:   ");
            object.append(f);
            Log.v((String)TAG, (String)object.toString());
        }
        object = new Canvas((Bitmap)bitmapPool);
        config = new Matrix();
        config.setScale(f, f);
        object.drawBitmap(bitmap, (Matrix)config, new Paint(6));
        return bitmapPool;
    }

    public static int getExifOrientationDegrees(int n) {
        switch (n) {
            default: {
                return 0;
            }
            case 7: 
            case 8: {
                return 270;
            }
            case 5: 
            case 6: {
                return 90;
            }
            case 3: 
            case 4: 
        }
        return 180;
    }

    @Deprecated
    @TargetApi(value=5)
    public static int getOrientation(String string2) {
        try {
            int n = TransformationUtils.getExifOrientationDegrees(new ExifInterface(string2).getAttributeInt("Orientation", 0));
            return n;
        }
        catch (Exception exception) {
            if (Log.isLoggable((String)TAG, (int)6)) {
                StringBuilder stringBuilder = new StringBuilder();
                stringBuilder.append("Unable to get orientation for image with path=");
                stringBuilder.append(string2);
                Log.e((String)TAG, (String)stringBuilder.toString(), (Throwable)exception);
            }
            return 0;
        }
    }

    private static Bitmap.Config getSafeConfig(Bitmap bitmap) {
        if (bitmap.getConfig() != null) {
            return bitmap.getConfig();
        }
        return Bitmap.Config.ARGB_8888;
    }

    static void initializeMatrixForRotation(int n, Matrix matrix) {
        switch (n) {
            default: {
                return;
            }
            case 8: {
                matrix.setRotate(-90.0f);
                return;
            }
            case 7: {
                matrix.setRotate(-90.0f);
                matrix.postScale(-1.0f, 1.0f);
                return;
            }
            case 6: {
                matrix.setRotate(90.0f);
                return;
            }
            case 5: {
                matrix.setRotate(90.0f);
                matrix.postScale(-1.0f, 1.0f);
                return;
            }
            case 4: {
                matrix.setRotate(180.0f);
                matrix.postScale(-1.0f, 1.0f);
                return;
            }
            case 3: {
                matrix.setRotate(180.0f);
                return;
            }
            case 2: 
        }
        matrix.setScale(-1.0f, 1.0f);
    }

    @Deprecated
    public static Bitmap orientImage(String string2, Bitmap bitmap) {
        return TransformationUtils.rotateImage(bitmap, TransformationUtils.getOrientation(string2));
    }

    public static Bitmap rotateImage(Bitmap bitmap, int n) {
        block3 : {
            if (n != 0) {
                try {
                    Matrix matrix = new Matrix();
                    matrix.setRotate((float)n);
                    matrix = Bitmap.createBitmap((Bitmap)bitmap, (int)0, (int)0, (int)bitmap.getWidth(), (int)bitmap.getHeight(), (Matrix)matrix, (boolean)true);
                    return matrix;
                }
                catch (Exception exception) {
                    if (!Log.isLoggable((String)TAG, (int)6)) break block3;
                    Log.e((String)TAG, (String)"Exception when trying to orient image", (Throwable)exception);
                }
            }
        }
        return bitmap;
    }

    public static Bitmap rotateImageExif(Bitmap bitmap, BitmapPool bitmapPool, int n) {
        Matrix matrix = new Matrix();
        TransformationUtils.initializeMatrixForRotation(n, matrix);
        if (matrix.isIdentity()) {
            return bitmap;
        }
        RectF rectF = new RectF(0.0f, 0.0f, (float)bitmap.getWidth(), (float)bitmap.getHeight());
        matrix.mapRect(rectF);
        n = Math.round(rectF.width());
        int n2 = Math.round(rectF.height());
        Bitmap.Config config = TransformationUtils.getSafeConfig(bitmap);
        Bitmap bitmap2 = bitmapPool.get(n, n2, config);
        bitmapPool = bitmap2;
        if (bitmap2 == null) {
            bitmapPool = Bitmap.createBitmap((int)n, (int)n2, (Bitmap.Config)config);
        }
        matrix.postTranslate(- rectF.left, - rectF.top);
        new Canvas((Bitmap)bitmapPool).drawBitmap(bitmap, matrix, new Paint(6));
        return bitmapPool;
    }

    @TargetApi(value=12)
    public static void setAlpha(Bitmap bitmap, Bitmap bitmap2) {
        if (Build.VERSION.SDK_INT >= 12 && bitmap2 != null) {
            bitmap2.setHasAlpha(bitmap.hasAlpha());
        }
    }
}

