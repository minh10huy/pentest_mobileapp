/*
 * Decompiled with CFR 0_132.
 * 
 * Could not load the following classes:
 *  android.util.Log
 *  android.util.SparseArray
 */
package com.google.android.gms.common.api.internal;

import android.support.annotation.NonNull;
import android.support.annotation.Nullable;
import android.util.Log;
import android.util.SparseArray;
import com.google.android.gms.common.ConnectionResult;
import com.google.android.gms.common.api.GoogleApiClient;
import com.google.android.gms.common.api.internal.LifecycleActivity;
import com.google.android.gms.common.api.internal.LifecycleCallback;
import com.google.android.gms.common.api.internal.LifecycleFragment;
import com.google.android.gms.common.api.internal.zzk;
import com.google.android.gms.common.api.internal.zzl;
import com.google.android.gms.common.internal.Preconditions;
import java.io.FileDescriptor;
import java.io.PrintWriter;
import java.util.concurrent.atomic.AtomicReference;

public class zzi
extends zzk {
    private final SparseArray<zza> zzed = new SparseArray();

    private zzi(LifecycleFragment lifecycleFragment) {
        super(lifecycleFragment);
        this.mLifecycleFragment.addCallback("AutoManageHelper", this);
    }

    public static zzi zza(LifecycleActivity object) {
        zzi zzi2 = (object = zzi.getFragment((LifecycleActivity)object)).getCallbackOrNull("AutoManageHelper", zzi.class);
        if (zzi2 != null) {
            return zzi2;
        }
        return new zzi((LifecycleFragment)object);
    }

    @Nullable
    private final zza zzd(int n) {
        if (this.zzed.size() <= n) {
            return null;
        }
        return (zza)this.zzed.get(this.zzed.keyAt(n));
    }

    @Override
    public final void dump(String string2, FileDescriptor fileDescriptor, PrintWriter printWriter, String[] arrstring) {
        for (int i = 0; i < this.zzed.size(); ++i) {
            zza zza2 = this.zzd(i);
            if (zza2 == null) continue;
            printWriter.append(string2).append("GoogleApiClient #").print(zza2.zzee);
            printWriter.println(":");
            zza2.zzef.dump(String.valueOf(string2).concat("  "), fileDescriptor, printWriter, arrstring);
        }
    }

    @Override
    public final void onStart() {
        super.onStart();
        boolean bl = this.mStarted;
        Object object = String.valueOf(this.zzed);
        StringBuilder stringBuilder = new StringBuilder(String.valueOf(object).length() + 14);
        stringBuilder.append("onStart ");
        stringBuilder.append(bl);
        stringBuilder.append(" ");
        stringBuilder.append((String)object);
        Log.d((String)"AutoManageHelper", (String)stringBuilder.toString());
        if (this.zzer.get() == null) {
            for (int i = 0; i < this.zzed.size(); ++i) {
                object = this.zzd(i);
                if (object == null) continue;
                object.zzef.connect();
            }
        }
    }

    @Override
    public void onStop() {
        super.onStop();
        for (int i = 0; i < this.zzed.size(); ++i) {
            zza zza2 = this.zzd(i);
            if (zza2 == null) continue;
            zza2.zzef.disconnect();
        }
    }

    public final void zza(int n, GoogleApiClient googleApiClient, GoogleApiClient.OnConnectionFailedListener object) {
        Preconditions.checkNotNull(googleApiClient, "GoogleApiClient instance cannot be null");
        boolean bl = this.zzed.indexOfKey(n) < 0;
        Object object2 = new StringBuilder(54);
        object2.append("Already managing a GoogleApiClient with id ");
        object2.append(n);
        Preconditions.checkState(bl, object2.toString());
        object2 = (zzl)this.zzer.get();
        bl = this.mStarted;
        String string2 = String.valueOf(object2);
        StringBuilder stringBuilder = new StringBuilder(String.valueOf(string2).length() + 49);
        stringBuilder.append("starting AutoManage for client ");
        stringBuilder.append(n);
        stringBuilder.append(" ");
        stringBuilder.append(bl);
        stringBuilder.append(" ");
        stringBuilder.append(string2);
        Log.d((String)"AutoManageHelper", (String)stringBuilder.toString());
        object = new zza(n, googleApiClient, (GoogleApiClient.OnConnectionFailedListener)object);
        this.zzed.put(n, object);
        if (this.mStarted && object2 == null) {
            object = String.valueOf(googleApiClient);
            object2 = new StringBuilder(String.valueOf(object).length() + 11);
            object2.append("connecting ");
            object2.append((String)object);
            Log.d((String)"AutoManageHelper", (String)object2.toString());
            googleApiClient.connect();
        }
    }

    @Override
    protected final void zza(ConnectionResult connectionResult, int n) {
        Log.w((String)"AutoManageHelper", (String)"Unresolved error while connecting client. Stopping auto-manage.");
        if (n < 0) {
            Log.wtf((String)"AutoManageHelper", (String)"AutoManageLifecycleHelper received onErrorResolutionFailed callback but no failing client ID is set", (Throwable)new Exception());
            return;
        }
        GoogleApiClient.OnConnectionFailedListener onConnectionFailedListener = (zza)this.zzed.get(n);
        if (onConnectionFailedListener != null) {
            this.zzc(n);
            onConnectionFailedListener = onConnectionFailedListener.zzeg;
            if (onConnectionFailedListener != null) {
                onConnectionFailedListener.onConnectionFailed(connectionResult);
            }
        }
    }

    public final void zzc(int n) {
        zza zza2 = (zza)this.zzed.get(n);
        this.zzed.remove(n);
        if (zza2 != null) {
            zza2.zzef.unregisterConnectionFailedListener(zza2);
            zza2.zzef.disconnect();
        }
    }

    @Override
    protected final void zzr() {
        for (int i = 0; i < this.zzed.size(); ++i) {
            zza zza2 = this.zzd(i);
            if (zza2 == null) continue;
            zza2.zzef.connect();
        }
    }

    private final class zza
    implements GoogleApiClient.OnConnectionFailedListener {
        public final int zzee;
        public final GoogleApiClient zzef;
        public final GoogleApiClient.OnConnectionFailedListener zzeg;

        public zza(int n, GoogleApiClient googleApiClient, GoogleApiClient.OnConnectionFailedListener onConnectionFailedListener) {
            this.zzee = n;
            this.zzef = googleApiClient;
            this.zzeg = onConnectionFailedListener;
            googleApiClient.registerConnectionFailedListener(this);
        }

        @Override
        public final void onConnectionFailed(@NonNull ConnectionResult connectionResult) {
            String string2 = String.valueOf(connectionResult);
            StringBuilder stringBuilder = new StringBuilder(String.valueOf(string2).length() + 27);
            stringBuilder.append("beginFailureResolution for ");
            stringBuilder.append(string2);
            Log.d((String)"AutoManageHelper", (String)stringBuilder.toString());
            zzi.this.zzb(connectionResult, this.zzee);
        }
    }

}

