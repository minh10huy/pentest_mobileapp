/*
 * Decompiled with CFR 0_132.
 * 
 * Could not load the following classes:
 *  android.content.SharedPreferences
 *  android.content.SharedPreferences$Editor
 *  android.util.Pair
 */
package com.google.android.gms.internal.measurement;

import android.content.SharedPreferences;
import android.support.annotation.WorkerThread;
import android.util.Pair;
import com.google.android.gms.common.internal.Preconditions;
import com.google.android.gms.common.util.Clock;
import com.google.android.gms.common.util.VisibleForTesting;
import com.google.android.gms.internal.measurement.zzft;
import com.google.android.gms.internal.measurement.zzfu;
import com.google.android.gms.internal.measurement.zzkd;
import java.security.SecureRandom;

public final class zzfx {
    private final long zzabi;
    private final /* synthetic */ zzft zzamp;
    @VisibleForTesting
    private final String zzamr;
    private final String zzams;
    private final String zzamt;

    private zzfx(zzft zzft2, String string2, long l) {
        this.zzamp = zzft2;
        Preconditions.checkNotEmpty(string2);
        boolean bl = l > 0L;
        Preconditions.checkArgument(bl);
        this.zzamr = String.valueOf(string2).concat(":start");
        this.zzams = String.valueOf(string2).concat(":count");
        this.zzamt = String.valueOf(string2).concat(":value");
        this.zzabi = l;
    }

    /* synthetic */ zzfx(zzft zzft2, String string2, long l, zzfu zzfu2) {
        this(zzft2, string2, l);
    }

    @WorkerThread
    private final void zzfh() {
        this.zzamp.zzab();
        long l = this.zzamp.zzbt().currentTimeMillis();
        SharedPreferences.Editor editor = zzft.zza(this.zzamp).edit();
        editor.remove(this.zzams);
        editor.remove(this.zzamt);
        editor.putLong(this.zzamr, l);
        editor.apply();
    }

    @WorkerThread
    private final long zzfj() {
        return zzft.zza(this.zzamp).getLong(this.zzamr, 0L);
    }

    @WorkerThread
    public final void zzc(String string2, long l) {
        long l2;
        this.zzamp.zzab();
        if (this.zzfj() == 0L) {
            this.zzfh();
        }
        String string3 = string2;
        if (string2 == null) {
            string3 = "";
        }
        if ((l2 = zzft.zza(this.zzamp).getLong(this.zzams, 0L)) <= 0L) {
            string2 = zzft.zza(this.zzamp).edit();
            string2.putString(this.zzamt, string3);
            string2.putLong(this.zzams, 1L);
            string2.apply();
            return;
        }
        l = this.zzamp.zzgg().zzlo().nextLong();
        boolean bl = (l & Long.MAX_VALUE) < Long.MAX_VALUE / ++l2;
        string2 = zzft.zza(this.zzamp).edit();
        if (bl) {
            string2.putString(this.zzamt, string3);
        }
        string2.putLong(this.zzams, l2);
        string2.apply();
    }

    @WorkerThread
    public final Pair<String, Long> zzfi() {
        this.zzamp.zzab();
        this.zzamp.zzab();
        long l = this.zzfj();
        if (l == 0L) {
            this.zzfh();
            l = 0L;
        } else {
            l = Math.abs(l - this.zzamp.zzbt().currentTimeMillis());
        }
        if (l < this.zzabi) {
            return null;
        }
        if (l > this.zzabi << 1) {
            this.zzfh();
            return null;
        }
        String string2 = zzft.zza(this.zzamp).getString(this.zzamt, null);
        l = zzft.zza(this.zzamp).getLong(this.zzams, 0L);
        this.zzfh();
        if (string2 != null && l > 0L) {
            return new Pair((Object)string2, (Object)l);
        }
        return zzft.zzalr;
    }
}

