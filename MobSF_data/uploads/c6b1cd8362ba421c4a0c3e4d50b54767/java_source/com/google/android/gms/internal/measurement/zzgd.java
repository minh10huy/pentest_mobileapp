/*
 * Decompiled with CFR 0_132.
 * 
 * Could not load the following classes:
 *  android.content.BroadcastReceiver
 *  android.content.BroadcastReceiver$PendingResult
 *  android.content.ComponentName
 *  android.content.Context
 *  android.content.Intent
 *  android.content.pm.ActivityInfo
 *  android.content.pm.PackageManager
 *  android.content.pm.PackageManager$NameNotFoundException
 *  android.net.Uri
 *  android.os.Bundle
 */
package com.google.android.gms.internal.measurement;

import android.content.BroadcastReceiver;
import android.content.ComponentName;
import android.content.Context;
import android.content.Intent;
import android.content.pm.ActivityInfo;
import android.content.pm.PackageManager;
import android.net.Uri;
import android.os.Bundle;
import android.support.annotation.MainThread;
import com.google.android.gms.common.internal.Preconditions;
import com.google.android.gms.internal.measurement.zzee;
import com.google.android.gms.internal.measurement.zzfi;
import com.google.android.gms.internal.measurement.zzfk;
import com.google.android.gms.internal.measurement.zzge;
import com.google.android.gms.internal.measurement.zzgf;
import com.google.android.gms.internal.measurement.zzgg;
import com.google.android.gms.internal.measurement.zzgi;
import com.google.android.gms.internal.measurement.zzgn;
import com.google.android.gms.internal.measurement.zzkd;

public final class zzgd {
    private final zzgg zzamz;

    public zzgd(zzgg zzgg2) {
        Preconditions.checkNotNull(zzgg2);
        this.zzamz = zzgg2;
    }

    public static boolean zza(Context context) {
        block5 : {
            PackageManager packageManager;
            block4 : {
                Preconditions.checkNotNull(context);
                try {
                    packageManager = context.getPackageManager();
                    if (packageManager != null) break block4;
                    return false;
                }
                catch (PackageManager.NameNotFoundException nameNotFoundException) {
                    return false;
                }
            }
            context = packageManager.getReceiverInfo(new ComponentName(context, "com.google.android.gms.measurement.AppMeasurementReceiver"), 0);
            if (context == null) break block5;
            boolean bl = context.enabled;
            if (!bl) break block5;
            return true;
        }
        return false;
    }

    @MainThread
    public final void onReceive(Context context, Intent intent) {
        zzgn zzgn2 = zzgn.zza(context, null, null);
        zzfi zzfi2 = zzgn2.zzgi();
        if (intent == null) {
            zzfi2.zziy().log("Receiver called with null intent");
            return;
        }
        zzgn2.zzgl();
        String string2 = intent.getAction();
        zzfi2.zzjc().zzg("Local receiver got", string2);
        if ("com.google.android.gms.measurement.UPLOAD".equals(string2)) {
            intent = new Intent().setClassName(context, "com.google.android.gms.measurement.AppMeasurementService");
            intent.setAction("com.google.android.gms.measurement.UPLOAD");
            zzfi2.zzjc().log("Starting wakeful intent.");
            this.zzamz.doStartService(context, intent);
            return;
        }
        if ("com.android.vending.INSTALL_REFERRER".equals(string2)) {
            try {
                zzgn2.zzgh().zzc(new zzge(this, zzgn2, zzfi2));
            }
            catch (Exception exception) {
                zzfi2.zziy().zzg("Install Referrer Reporter encountered a problem", exception);
            }
            BroadcastReceiver.PendingResult pendingResult = this.zzamz.doGoAsync();
            String string3 = intent.getStringExtra("referrer");
            if (string3 == null) {
                zzfi2.zzjc().log("Install referrer extras are null");
                if (pendingResult != null) {
                    pendingResult.finish();
                }
                return;
            }
            zzfi2.zzja().zzg("Install referrer extras are", string3);
            string2 = string3;
            if (!string3.contains("?")) {
                string2 = String.valueOf(string3);
                string2 = string2.length() != 0 ? "?".concat(string2) : new String("?");
            }
            string2 = Uri.parse((String)string2);
            string2 = zzgn2.zzgg().zza((Uri)string2);
            if (string2 == null) {
                zzfi2.zzjc().log("No campaign defined in install referrer broadcast");
                if (pendingResult != null) {
                    pendingResult.finish();
                    return;
                }
            } else {
                long l = intent.getLongExtra("referrer_timestamp_seconds", 0L) * 1000L;
                if (l == 0L) {
                    zzfi2.zziy().log("Install referrer is missing timestamp");
                }
                zzgn2.zzgh().zzc(new zzgf(this, zzgn2, l, (Bundle)string2, context, zzfi2, pendingResult));
            }
        }
    }
}

