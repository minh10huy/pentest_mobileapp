/*
 * Decompiled with CFR 0_132.
 * 
 * Could not load the following classes:
 *  android.app.PendingIntent
 *  android.content.ComponentName
 *  android.content.Context
 *  android.content.Intent
 *  android.content.pm.PackageManager
 *  android.content.pm.ResolveInfo
 *  android.content.pm.ServiceInfo
 *  android.os.Parcelable
 *  android.util.Log
 *  javax.annotation.concurrent.GuardedBy
 */
package com.google.firebase.iid;

import android.app.PendingIntent;
import android.content.ComponentName;
import android.content.Context;
import android.content.Intent;
import android.content.pm.PackageManager;
import android.content.pm.ResolveInfo;
import android.content.pm.ServiceInfo;
import android.os.Parcelable;
import android.support.annotation.VisibleForTesting;
import android.support.v4.content.WakefulBroadcastReceiver;
import android.support.v4.util.SimpleArrayMap;
import android.util.Log;
import com.google.firebase.iid.FirebaseInstanceIdReceiver;
import java.util.ArrayDeque;
import java.util.Queue;
import javax.annotation.concurrent.GuardedBy;

public final class zzat {
    private static zzat zzco;
    @GuardedBy(value="serviceClassNames")
    private final SimpleArrayMap<String, String> zzcp = new SimpleArrayMap();
    private Boolean zzcq = null;
    @VisibleForTesting
    final Queue<Intent> zzcr = new ArrayDeque<Intent>();
    @VisibleForTesting
    private final Queue<Intent> zzcs = new ArrayDeque<Intent>();

    private zzat() {
    }

    public static PendingIntent zza(Context context, int n, Intent intent, int n2) {
        return PendingIntent.getBroadcast((Context)context, (int)n, (Intent)zzat.zza(context, "com.google.firebase.MESSAGING_EVENT", intent), (int)1073741824);
    }

    private static Intent zza(Context context, String string2, Intent intent) {
        context = new Intent(context, FirebaseInstanceIdReceiver.class);
        context.setAction(string2);
        context.putExtra("wrapped_intent", (Parcelable)intent);
        return context;
    }

    public static zzat zzah() {
        synchronized (zzat.class) {
            if (zzco == null) {
                zzco = new zzat();
            }
            zzat zzat2 = zzco;
            return zzat2;
        }
    }

    public static void zzb(Context context, Intent intent) {
        context.sendBroadcast(zzat.zza(context, "com.google.firebase.INSTANCE_ID_EVENT", intent));
    }

    public static void zzc(Context context, Intent intent) {
        context.sendBroadcast(zzat.zza(context, "com.google.firebase.MESSAGING_EVENT", intent));
    }

    /*
     * Enabled aggressive block sorting
     * Enabled unnecessary exception pruning
     * Enabled aggressive exception aggregation
     */
    private final int zzd(Context context, Intent object) {
        boolean bl;
        block18 : {
            Object object2;
            Object object3;
            block15 : {
                block16 : {
                    block17 : {
                        object3 = this.zzcp;
                        synchronized (object3) {
                            object2 = this.zzcp.get(object.getAction());
                        }
                        bl = false;
                        object3 = object2;
                        if (object2 != null) break block15;
                        object3 = context.getPackageManager().resolveService((Intent)object, 0);
                        if (object3 == null || object3.serviceInfo == null) break block16;
                        object2 = object3.serviceInfo;
                        if (!context.getPackageName().equals(object2.packageName) || object2.name == null) break block17;
                        object3 = object2 = object2.name;
                        if (object2.startsWith(".")) {
                            object3 = String.valueOf(context.getPackageName());
                            object3 = (object2 = String.valueOf(object2)).length() != 0 ? object3.concat((String)object2) : new String((String)object3);
                        }
                        object2 = this.zzcp;
                        synchronized (object2) {
                            this.zzcp.put(object.getAction(), (String)object3);
                            break block15;
                        }
                    }
                    object3 = object2.packageName;
                    object2 = object2.name;
                    StringBuilder stringBuilder = new StringBuilder(String.valueOf(object3).length() + 94 + String.valueOf(object2).length());
                    stringBuilder.append("Error resolving target intent service, skipping classname enforcement. Resolved service was: ");
                    stringBuilder.append((String)object3);
                    stringBuilder.append("/");
                    stringBuilder.append((String)object2);
                    Log.e((String)"FirebaseInstanceId", (String)stringBuilder.toString());
                    break block18;
                }
                Log.e((String)"FirebaseInstanceId", (String)"Failed to resolve target intent service, skipping classname enforcement");
                break block18;
            }
            if (Log.isLoggable((String)"FirebaseInstanceId", (int)3)) {
                object2 = String.valueOf(object3);
                object2 = object2.length() != 0 ? "Restricting intent to a specific service: ".concat((String)object2) : new String("Restricting intent to a specific service: ");
                Log.d((String)"FirebaseInstanceId", (String)object2);
            }
            object.setClassName(context.getPackageName(), (String)object3);
        }
        try {
            if (this.zzcq == null) {
                if (context.checkCallingOrSelfPermission("android.permission.WAKE_LOCK") == 0) {
                    bl = true;
                }
                this.zzcq = bl;
            }
            if (this.zzcq.booleanValue()) {
                context = WakefulBroadcastReceiver.startWakefulService(context, (Intent)object);
            } else {
                context = context.startService((Intent)object);
                Log.d((String)"FirebaseInstanceId", (String)"Missing wake lock permission, service start may be delayed");
            }
            if (context == null) {
                Log.e((String)"FirebaseInstanceId", (String)"Error while delivering the message: ServiceIntent not found.");
                return 404;
            }
            return -1;
        }
        catch (IllegalStateException illegalStateException) {
            String string2 = String.valueOf(illegalStateException);
            object = new StringBuilder(String.valueOf(string2).length() + 45);
            object.append("Failed to start service while in background: ");
            object.append(string2);
            Log.e((String)"FirebaseInstanceId", (String)object.toString());
            return 402;
        }
        catch (SecurityException securityException) {
            Log.e((String)"FirebaseInstanceId", (String)"Error while delivering the message to the serviceIntent", (Throwable)securityException);
            return 401;
        }
    }

    public final Intent zzai() {
        return this.zzcs.poll();
    }

    /*
     * Unable to fully structure code
     * Enabled aggressive block sorting
     * Lifted jumps to return sites
     */
    public final int zzb(Context var1_1, String var2_2, Intent var3_3) {
        block7 : {
            block6 : {
                var4_4 = var2_2.hashCode();
                if (var4_4 == -842411455) break block6;
                if (var4_4 != 41532704 || !var2_2.equals("com.google.firebase.MESSAGING_EVENT")) ** GOTO lbl-1000
                var4_4 = 1;
                break block7;
            }
            if (var2_2.equals("com.google.firebase.INSTANCE_ID_EVENT")) {
                var4_4 = 0;
            } else lbl-1000: // 2 sources:
            {
                var4_4 = -1;
            }
        }
        switch (var4_4) {
            default: {
                var1_1 = String.valueOf(var2_2);
                var1_1 = var1_1.length() != 0 ? "Unknown service action: ".concat((String)var1_1) : new String("Unknown service action: ");
            }
            case 1: {
                var5_5 = this.zzcs;
                ** break;
            }
            case 0: {
                var5_5 = this.zzcr;
lbl21: // 2 sources:
                var5_5.offer(var3_3);
                var2_2 = new Intent(var2_2);
                var2_2.setPackage(var1_1.getPackageName());
                return this.zzd((Context)var1_1, (Intent)var2_2);
            }
        }
        Log.w((String)"FirebaseInstanceId", (String)var1_1);
        return 500;
    }
}

