/*
 * Decompiled with CFR 0_132.
 * 
 * Could not load the following classes:
 *  android.text.TextUtils
 *  android.util.Log
 */
package com.google.firebase.iid;

import android.support.annotation.GuardedBy;
import android.support.annotation.Nullable;
import android.support.annotation.WorkerThread;
import android.support.v4.util.ArrayMap;
import android.text.TextUtils;
import android.util.Log;
import com.google.android.gms.tasks.Task;
import com.google.android.gms.tasks.TaskCompletionSource;
import com.google.firebase.iid.FirebaseInstanceId;
import com.google.firebase.iid.zzau;
import java.io.IOException;
import java.util.Map;

final class zzay {
    @GuardedBy(value="itself")
    private final zzau zzag;
    @GuardedBy(value="this")
    private int zzdc = 0;
    @GuardedBy(value="this")
    private final Map<Integer, TaskCompletionSource<Void>> zzdd = new ArrayMap<Integer, TaskCompletionSource<Void>>();

    zzay(zzau zzau2) {
        this.zzag = zzau2;
    }

    /*
     * Unable to fully structure code
     * Enabled aggressive block sorting
     * Enabled unnecessary exception pruning
     * Enabled aggressive exception aggregation
     * Lifted jumps to return sites
     */
    @WorkerThread
    private static boolean zza(FirebaseInstanceId var0, String var1_3) {
        var4_4 /* !! */  = var1_3.split("!");
        if (var4_4 /* !! */ .length != 2) return true;
        var1_3 = var4_4 /* !! */ [0];
        var4_4 /* !! */  = var4_4 /* !! */ [1];
        var2_5 = -1;
        try {
            var3_6 = var1_3.hashCode();
            if (var3_6 != 83) {
                if (var3_6 == 85 && var1_3.equals("U")) {
                    var2_5 = 1;
                }
            } else if (var1_3.equals("S")) {
                var2_5 = 0;
            }
        }
        catch (IOException var0_1) {
            var0_2 = String.valueOf(var0_1.getMessage());
            var0_2 = var0_2.length() != 0 ? "Topic sync failed: ".concat(var0_2) : new String("Topic sync failed: ");
            Log.e((String)"FirebaseInstanceId", (String)var0_2);
            return false;
        }
        switch (var2_5) {
            case 1: {
                var0.zzc((String)var4_4 /* !! */ );
                if (FirebaseInstanceId.zzk() == false) return true;
                var0 = "unsubscribe operation succeeded";
                ** GOTO lbl30
            }
            case 0: {
                var0.zzb((String)var4_4 /* !! */ );
                if (FirebaseInstanceId.zzk() == false) return true;
                var0 = "subscribe operation succeeded";
lbl30: // 2 sources:
                Log.d((String)"FirebaseInstanceId", (String)var0);
                return true;
            }
        }
        return true;
    }

    /*
     * Enabled aggressive block sorting
     * Enabled unnecessary exception pruning
     * Enabled aggressive exception aggregation
     * Converted monitor instructions to comments
     * Lifted jumps to return sites
     */
    @GuardedBy(value="this")
    @Nullable
    private final String zzaq() {
        String[] arrstring = this.zzag;
        // MONITORENTER : arrstring
        String string2 = this.zzag.zzaj();
        // MONITOREXIT : arrstring
        if (TextUtils.isEmpty((CharSequence)string2)) return null;
        arrstring = string2.split(",");
        if (arrstring.length <= 1) return null;
        if (TextUtils.isEmpty((CharSequence)arrstring[1])) return null;
        return arrstring[1];
    }

    /*
     * Enabled aggressive block sorting
     * Enabled unnecessary exception pruning
     * Enabled aggressive exception aggregation
     */
    private final boolean zzk(String string2) {
        synchronized (this) {
            zzau zzau2 = this.zzag;
            synchronized (zzau2) {
                String string3 = this.zzag.zzaj();
                String string4 = String.valueOf(",");
                String string5 = String.valueOf(string2);
                string4 = string5.length() != 0 ? string4.concat(string5) : new String(string4);
                if (!string3.startsWith(string4)) {
                    return false;
                }
                string4 = String.valueOf(",");
                string2 = (string2 = String.valueOf(string2)).length() != 0 ? string4.concat(string2) : new String(string4);
                string2 = string3.substring(string2.length());
                this.zzag.zzf(string2);
                return true;
            }
        }
    }

    /*
     * Enabled aggressive block sorting
     * Enabled unnecessary exception pruning
     * Enabled aggressive exception aggregation
     */
    final Task<Void> zza(String task) {
        synchronized (this) {
            String string2;
            Object object = this.zzag;
            synchronized (object) {
                string2 = this.zzag.zzaj();
                zzau zzau2 = this.zzag;
                StringBuilder stringBuilder = new StringBuilder(String.valueOf(string2).length() + 1 + String.valueOf(task).length());
                stringBuilder.append(string2);
                stringBuilder.append(",");
                stringBuilder.append((String)((Object)task));
                zzau2.zzf(stringBuilder.toString());
            }
            task = new TaskCompletionSource();
            object = this.zzdd;
            int n = TextUtils.isEmpty((CharSequence)string2) ? 0 : string2.split(",").length - 1;
            object.put(this.zzdc + n, task);
            return task.getTask();
        }
    }

    /*
     * Enabled aggressive block sorting
     * Enabled unnecessary exception pruning
     * Enabled aggressive exception aggregation
     * Converted monitor instructions to comments
     * Lifted jumps to return sites
     */
    @WorkerThread
    final boolean zza(FirebaseInstanceId firebaseInstanceId) {
        do {
            // MONITORENTER : this
            String string2 = this.zzaq();
            if (string2 == null) {
                Log.d((String)"FirebaseInstanceId", (String)"topic sync succeeded");
                // MONITOREXIT : this
                return true;
            }
            // MONITOREXIT : this
            if (!zzay.zza(firebaseInstanceId, string2)) {
                return false;
            }
            // MONITORENTER : this
            TaskCompletionSource<Void> taskCompletionSource = this.zzdd.remove(this.zzdc);
            this.zzk(string2);
            ++this.zzdc;
            // MONITOREXIT : this
            if (taskCompletionSource == null) continue;
            taskCompletionSource.setResult(null);
        } while (true);
    }

    /*
     * Enabled force condition propagation
     * Lifted jumps to return sites
     */
    final boolean zzap() {
        synchronized (this) {
            String string2 = this.zzaq();
            if (string2 == null) return false;
            return true;
        }
    }
}

