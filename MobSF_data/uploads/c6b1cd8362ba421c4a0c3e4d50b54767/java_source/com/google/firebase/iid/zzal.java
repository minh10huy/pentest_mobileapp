/*
 * Decompiled with CFR 0_132.
 * 
 * Could not load the following classes:
 *  android.content.Context
 *  android.content.Intent
 *  android.content.pm.PackageInfo
 *  android.content.pm.PackageManager
 *  android.content.pm.PackageManager$NameNotFoundException
 *  android.util.Base64
 *  android.util.Log
 *  javax.annotation.concurrent.GuardedBy
 */
package com.google.firebase.iid;

import android.content.Context;
import android.content.Intent;
import android.content.pm.PackageInfo;
import android.content.pm.PackageManager;
import android.util.Base64;
import android.util.Log;
import com.google.android.gms.common.util.PlatformVersion;
import com.google.firebase.FirebaseApp;
import com.google.firebase.FirebaseOptions;
import java.security.KeyPair;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;
import java.security.PublicKey;
import java.util.List;
import javax.annotation.concurrent.GuardedBy;

public final class zzal {
    @GuardedBy(value="this")
    private String zzbz;
    @GuardedBy(value="this")
    private String zzca;
    @GuardedBy(value="this")
    private int zzcb;
    @GuardedBy(value="this")
    private int zzcc = 0;
    private final Context zzv;

    public zzal(Context context) {
        this.zzv = context;
    }

    public static String zza(FirebaseApp object) {
        String string2 = object.getOptions().getGcmSenderId();
        if (string2 != null) {
            return string2;
        }
        if (!(object = object.getOptions().getApplicationId()).startsWith("1:")) {
            return object;
        }
        if (((String[])(object = object.split(":"))).length < 2) {
            return null;
        }
        if ((object = object[1]).isEmpty()) {
            return null;
        }
        return object;
    }

    /*
     * Enabled aggressive block sorting
     * Enabled unnecessary exception pruning
     * Enabled aggressive exception aggregation
     */
    public static String zza(KeyPair object) {
        byte[] arrby;
        byte[] arrby2 = object.getPublic().getEncoded();
        try {
            arrby = MessageDigest.getInstance("SHA1").digest(arrby2);
        }
        catch (NoSuchAlgorithmException noSuchAlgorithmException) {}
        arrby[0] = (byte)((arrby[0] & 15) + 112);
        return Base64.encodeToString((byte[])arrby, (int)0, (int)8, (int)11);
        Log.w((String)"FirebaseInstanceId", (String)"Unexpected error, device missing required algorithms");
        return null;
    }

    /*
     * Enabled aggressive block sorting
     * Enabled unnecessary exception pruning
     * Enabled aggressive exception aggregation
     */
    private final void zzaf() {
        synchronized (this) {
            PackageInfo packageInfo = this.zze(this.zzv.getPackageName());
            if (packageInfo != null) {
                this.zzbz = Integer.toString(packageInfo.versionCode);
                this.zzca = packageInfo.versionName;
            }
            return;
        }
    }

    private final PackageInfo zze(String string2) {
        try {
            string2 = this.zzv.getPackageManager().getPackageInfo(string2, 0);
            return string2;
        }
        catch (PackageManager.NameNotFoundException nameNotFoundException) {
            String string3 = String.valueOf((Object)nameNotFoundException);
            StringBuilder stringBuilder = new StringBuilder(String.valueOf(string3).length() + 23);
            stringBuilder.append("Failed to find package ");
            stringBuilder.append(string3);
            Log.w((String)"FirebaseInstanceId", (String)stringBuilder.toString());
            return null;
        }
    }

    public final int zzab() {
        synchronized (this) {
            block12 : {
                Object object;
                Object object2;
                block11 : {
                    block10 : {
                        block9 : {
                            if (this.zzcc == 0) break block9;
                            int n = this.zzcc;
                            return n;
                        }
                        object2 = this.zzv.getPackageManager();
                        if (object2.checkPermission("com.google.android.c2dm.permission.SEND", "com.google.android.gms") != -1) break block10;
                        Log.e((String)"FirebaseInstanceId", (String)"Google Play services missing or without correct permission.");
                        return 0;
                    }
                    if (PlatformVersion.isAtLeastO()) break block11;
                    object = new Intent("com.google.android.c2dm.intent.REGISTER");
                    object.setPackage("com.google.android.gms");
                    object = object2.queryIntentServices((Intent)object, 0);
                    if (object == null) break block11;
                    if (object.size() <= 0) break block11;
                    int n = this.zzcc = 1;
                    return n;
                }
                object = new Intent("com.google.iid.TOKEN_REQUEST");
                object.setPackage("com.google.android.gms");
                object2 = object2.queryBroadcastReceivers((Intent)object, 0);
                if (object2 == null) break block12;
                if (object2.size() <= 0) break block12;
                int n = this.zzcc = 2;
                return n;
            }
            Log.w((String)"FirebaseInstanceId", (String)"Failed to resolve IID implementation package, falling back");
            this.zzcc = PlatformVersion.isAtLeastO() ? 2 : 1;
            int n = this.zzcc;
            return n;
        }
    }

    public final String zzac() {
        synchronized (this) {
            if (this.zzbz == null) {
                this.zzaf();
            }
            String string2 = this.zzbz;
            return string2;
        }
    }

    public final String zzad() {
        synchronized (this) {
            if (this.zzca == null) {
                this.zzaf();
            }
            String string2 = this.zzca;
            return string2;
        }
    }

    /*
     * Enabled force condition propagation
     * Lifted jumps to return sites
     */
    public final int zzae() {
        synchronized (this) {
            if (this.zzcb != 0) return this.zzcb;
            PackageInfo packageInfo = this.zze("com.google.android.gms");
            if (packageInfo == null) return this.zzcb;
            this.zzcb = packageInfo.versionCode;
            return this.zzcb;
        }
    }
}

