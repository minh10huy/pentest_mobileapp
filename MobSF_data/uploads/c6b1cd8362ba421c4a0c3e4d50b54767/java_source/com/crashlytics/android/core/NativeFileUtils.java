/*
 * Decompiled with CFR 0_132.
 * 
 * Could not load the following classes:
 *  android.content.Context
 */
package com.crashlytics.android.core;

import android.content.Context;
import com.crashlytics.android.core.BinaryImagesConverter;
import com.crashlytics.android.core.Sha1FileIdStrategy;
import io.fabric.sdk.android.services.common.CommonUtils;
import java.io.BufferedReader;
import java.io.ByteArrayOutputStream;
import java.io.Closeable;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.Reader;

final class NativeFileUtils {
    private NativeFileUtils() {
    }

    private static byte[] binaryImagesJsonFromBinaryLibsFile(File arrby, Context context) throws IOException {
        if ((arrby = NativeFileUtils.readFile((File)arrby)) != null && arrby.length != 0) {
            return NativeFileUtils.processBinaryImages(context, new String(arrby));
        }
        return null;
    }

    static byte[] binaryImagesJsonFromDirectory(File file, Context context) throws IOException {
        File file2 = NativeFileUtils.filter(file, ".maps");
        if (file2 != null) {
            return NativeFileUtils.binaryImagesJsonFromMapsFile(file2, context);
        }
        if ((file = NativeFileUtils.filter(file, ".binary_libs")) != null) {
            return NativeFileUtils.binaryImagesJsonFromBinaryLibsFile(file, context);
        }
        return null;
    }

    /*
     * Loose catch block
     * Enabled aggressive block sorting
     * Enabled unnecessary exception pruning
     * Enabled aggressive exception aggregation
     * Lifted jumps to return sites
     */
    private static byte[] binaryImagesJsonFromMapsFile(File object, Context arrby) throws IOException {
        void var1_4;
        block5 : {
            if (!object.exists()) {
                return null;
            }
            object = new BufferedReader(new FileReader((File)object));
            try {
                arrby = new BinaryImagesConverter((Context)arrby, new Sha1FileIdStrategy()).convert((BufferedReader)object);
            }
            catch (Throwable throwable) {
                break block5;
            }
            CommonUtils.closeQuietly((Closeable)object);
            return arrby;
            catch (Throwable throwable) {
                object = null;
            }
        }
        CommonUtils.closeQuietly((Closeable)object);
        throw var1_4;
    }

    private static File filter(File arrfile, String string2) {
        for (File file : arrfile.listFiles()) {
            if (!file.getName().endsWith(string2)) continue;
            return file;
        }
        return null;
    }

    static byte[] metadataJsonFromDirectory(File file) {
        if ((file = NativeFileUtils.filter(file, ".device_info")) == null) {
            return null;
        }
        return NativeFileUtils.readFile(file);
    }

    static byte[] minidumpFromDirectory(File file) {
        if ((file = NativeFileUtils.filter(file, ".dmp")) == null) {
            return new byte[0];
        }
        return NativeFileUtils.minidumpFromFile(file);
    }

    private static byte[] minidumpFromFile(File file) {
        return NativeFileUtils.readFile(file);
    }

    private static byte[] processBinaryImages(Context context, String string2) throws IOException {
        return new BinaryImagesConverter(context, new Sha1FileIdStrategy()).convert(string2);
    }

    private static byte[] readBytes(InputStream inputStream) throws IOException {
        int n;
        byte[] arrby = new byte[1024];
        ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
        while ((n = inputStream.read(arrby)) != -1) {
            byteArrayOutputStream.write(arrby, 0, n);
        }
        return byteArrayOutputStream.toByteArray();
    }

    /*
     * Loose catch block
     * Enabled aggressive block sorting
     * Enabled unnecessary exception pruning
     * Enabled aggressive exception aggregation
     * Lifted jumps to return sites
     */
    static byte[] readFile(File object) {
        block10 : {
            block9 : {
                void var1_7;
                block8 : {
                    byte[] arrby;
                    Object var2_3 = null;
                    object = new FileInputStream((File)object);
                    try {
                        arrby = NativeFileUtils.readBytes((InputStream)object);
                    }
                    catch (Throwable throwable) {
                        break block8;
                    }
                    CommonUtils.closeQuietly((Closeable)object);
                    return arrby;
                    catch (Throwable throwable) {
                        object = var2_3;
                    }
                }
                CommonUtils.closeQuietly((Closeable)object);
                throw var1_7;
                catch (FileNotFoundException fileNotFoundException) {}
                object = null;
                break block9;
                catch (IOException iOException) {}
                object = null;
                break block10;
                catch (FileNotFoundException fileNotFoundException) {}
            }
            CommonUtils.closeQuietly((Closeable)object);
            return null;
            catch (IOException iOException) {}
        }
        CommonUtils.closeQuietly((Closeable)object);
        return null;
    }
}

