/*
 * Decompiled with CFR 0_132.
 */
package android.support.constraint.solver;

import android.support.constraint.solver.ArrayLinkedVariables;
import android.support.constraint.solver.ArrayRow;
import android.support.constraint.solver.Cache;
import android.support.constraint.solver.GoalRow;
import android.support.constraint.solver.Metrics;
import android.support.constraint.solver.Pools;
import android.support.constraint.solver.SolverVariable;
import android.support.constraint.solver.widgets.ConstraintAnchor;
import android.support.constraint.solver.widgets.ConstraintWidget;
import java.io.PrintStream;
import java.util.Arrays;
import java.util.HashMap;

public class LinearSystem {
    private static final boolean DEBUG = false;
    public static final boolean FULL_DEBUG = false;
    private static int POOL_SIZE = 1000;
    public static Metrics sMetrics;
    private int TABLE_SIZE;
    public boolean graphOptimizer = false;
    private boolean[] mAlreadyTestedCandidates = new boolean[this.TABLE_SIZE];
    final Cache mCache;
    private Row mGoal;
    private int mMaxColumns = this.TABLE_SIZE = 32;
    private int mMaxRows = this.TABLE_SIZE;
    int mNumColumns = 1;
    int mNumRows = 0;
    private SolverVariable[] mPoolVariables = new SolverVariable[POOL_SIZE];
    private int mPoolVariablesCount = 0;
    ArrayRow[] mRows = new ArrayRow[this.TABLE_SIZE];
    private final Row mTempGoal;
    private HashMap<String, SolverVariable> mVariables = null;
    int mVariablesID = 0;
    private ArrayRow[] tempClientsCopy = new ArrayRow[this.TABLE_SIZE];

    public LinearSystem() {
        this.releaseRows();
        this.mCache = new Cache();
        this.mGoal = new GoalRow(this.mCache);
        this.mTempGoal = new ArrayRow(this.mCache);
    }

    private SolverVariable acquireSolverVariable(SolverVariable.Type object, String arrsolverVariable) {
        SolverVariable solverVariable = this.mCache.solverVariablePool.acquire();
        if (solverVariable == null) {
            solverVariable = new SolverVariable((SolverVariable.Type)((Object)object), (String)arrsolverVariable);
            solverVariable.setType((SolverVariable.Type)((Object)object), (String)arrsolverVariable);
            object = solverVariable;
        } else {
            solverVariable.reset();
            solverVariable.setType((SolverVariable.Type)((Object)object), (String)arrsolverVariable);
            object = solverVariable;
        }
        if (this.mPoolVariablesCount >= POOL_SIZE) {
            this.mPoolVariables = Arrays.copyOf(this.mPoolVariables, POOL_SIZE *= 2);
        }
        arrsolverVariable = this.mPoolVariables;
        int n = this.mPoolVariablesCount;
        this.mPoolVariablesCount = n + 1;
        arrsolverVariable[n] = object;
        return object;
    }

    private void addError(ArrayRow arrayRow) {
        arrayRow.addError(this, 0);
    }

    private final void addRow(ArrayRow arrayRow) {
        if (this.mRows[this.mNumRows] != null) {
            this.mCache.arrayRowPool.release(this.mRows[this.mNumRows]);
        }
        this.mRows[this.mNumRows] = arrayRow;
        arrayRow.variable.definitionId = this.mNumRows++;
        arrayRow.variable.updateReferencesWithNewDefinition(arrayRow);
    }

    private void addSingleError(ArrayRow arrayRow, int n) {
        this.addSingleError(arrayRow, n, 0);
    }

    private void computeValues() {
        for (int i = 0; i < this.mNumRows; ++i) {
            ArrayRow arrayRow = this.mRows[i];
            arrayRow.variable.computedValue = arrayRow.constantValue;
        }
    }

    public static ArrayRow createRowCentering(LinearSystem linearSystem, SolverVariable solverVariable, SolverVariable solverVariable2, int n, float f, SolverVariable solverVariable3, SolverVariable solverVariable4, int n2, boolean bl) {
        ArrayRow arrayRow = linearSystem.createRow();
        arrayRow.createRowCentering(solverVariable, solverVariable2, n, f, solverVariable3, solverVariable4, n2);
        if (bl) {
            arrayRow.addError(linearSystem, 4);
        }
        return arrayRow;
    }

    public static ArrayRow createRowDimensionPercent(LinearSystem linearSystem, SolverVariable solverVariable, SolverVariable solverVariable2, SolverVariable solverVariable3, float f, boolean bl) {
        ArrayRow arrayRow = linearSystem.createRow();
        if (bl) {
            linearSystem.addError(arrayRow);
        }
        return arrayRow.createRowDimensionPercent(solverVariable, solverVariable2, solverVariable3, f);
    }

    public static ArrayRow createRowEquals(LinearSystem linearSystem, SolverVariable solverVariable, SolverVariable solverVariable2, int n, boolean bl) {
        ArrayRow arrayRow = linearSystem.createRow();
        arrayRow.createRowEquals(solverVariable, solverVariable2, n);
        if (bl) {
            linearSystem.addSingleError(arrayRow, 1);
        }
        return arrayRow;
    }

    public static ArrayRow createRowGreaterThan(LinearSystem linearSystem, SolverVariable solverVariable, SolverVariable solverVariable2, int n, boolean bl) {
        SolverVariable solverVariable3 = linearSystem.createSlackVariable();
        ArrayRow arrayRow = linearSystem.createRow();
        arrayRow.createRowGreaterThan(solverVariable, solverVariable2, solverVariable3, n);
        if (bl) {
            linearSystem.addSingleError(arrayRow, (int)(arrayRow.variables.get(solverVariable3) * -1.0f));
        }
        return arrayRow;
    }

    public static ArrayRow createRowLowerThan(LinearSystem linearSystem, SolverVariable solverVariable, SolverVariable solverVariable2, int n, boolean bl) {
        SolverVariable solverVariable3 = linearSystem.createSlackVariable();
        ArrayRow arrayRow = linearSystem.createRow();
        arrayRow.createRowLowerThan(solverVariable, solverVariable2, solverVariable3, n);
        if (bl) {
            linearSystem.addSingleError(arrayRow, (int)(arrayRow.variables.get(solverVariable3) * -1.0f));
        }
        return arrayRow;
    }

    private SolverVariable createVariable(String string2, SolverVariable.Type object) {
        if (sMetrics != null) {
            Metrics metrics = sMetrics;
            ++metrics.variables;
        }
        if (this.mNumColumns + 1 >= this.mMaxColumns) {
            this.increaseTableSize();
        }
        object = this.acquireSolverVariable((SolverVariable.Type)((Object)object), null);
        object.setName(string2);
        ++this.mVariablesID;
        ++this.mNumColumns;
        object.id = this.mVariablesID;
        if (this.mVariables == null) {
            this.mVariables = new HashMap();
        }
        this.mVariables.put(string2, (SolverVariable)object);
        this.mCache.mIndexedVariables[this.mVariablesID] = object;
        return object;
    }

    private void displayRows() {
        StringBuilder stringBuilder;
        this.displaySolverVariables();
        String string2 = "";
        for (int i = 0; i < this.mNumRows; ++i) {
            stringBuilder = new StringBuilder();
            stringBuilder.append(string2);
            stringBuilder.append(this.mRows[i]);
            string2 = stringBuilder.toString();
            stringBuilder = new StringBuilder();
            stringBuilder.append(string2);
            stringBuilder.append("\n");
            string2 = stringBuilder.toString();
        }
        stringBuilder = new StringBuilder();
        stringBuilder.append(string2);
        stringBuilder.append(this.mGoal);
        stringBuilder.append("\n");
        string2 = stringBuilder.toString();
        System.out.println(string2);
    }

    private void displaySolverVariables() {
        CharSequence charSequence = new StringBuilder();
        charSequence.append("Display Rows (");
        charSequence.append(this.mNumRows);
        charSequence.append("x");
        charSequence.append(this.mNumColumns);
        charSequence.append(")\n");
        charSequence = charSequence.toString();
        System.out.println((String)charSequence);
    }

    private int enforceBFS(Row object) throws Exception {
        block14 : {
            int n;
            block13 : {
                for (n = 0; n < this.mNumRows; ++n) {
                    if (this.mRows[n].variable.mType == SolverVariable.Type.UNRESTRICTED || this.mRows[n].constantValue >= 0.0f) continue;
                    n = 1;
                    break block13;
                }
                n = 0;
            }
            if (n == 0) break block14;
            boolean bl = false;
            n = 0;
            while (!bl) {
                Object object2;
                if (sMetrics != null) {
                    object = sMetrics;
                    ++object.bfs;
                }
                int n2 = n + 1;
                n = -1;
                int n3 = -1;
                float f = Float.MAX_VALUE;
                int n4 = 0;
                for (int i = 0; i < this.mNumRows; ++i) {
                    float f2;
                    int n5;
                    int n6;
                    int n7;
                    block16 : {
                        block17 : {
                            block15 : {
                                object = this.mRows[i];
                                if (object.variable.mType != SolverVariable.Type.UNRESTRICTED) break block15;
                                n5 = n;
                                n6 = n3;
                                f2 = f;
                                n7 = n4;
                                break block16;
                            }
                            if (!object.isSimpleDefinition) break block17;
                            n5 = n;
                            n6 = n3;
                            f2 = f;
                            n7 = n4;
                            break block16;
                        }
                        n5 = n;
                        n6 = n3;
                        f2 = f;
                        n7 = n4;
                        if (object.constantValue >= 0.0f) break block16;
                        int n8 = 1;
                        do {
                            block18 : {
                                n5 = n;
                                n6 = n3;
                                f2 = f;
                                n7 = n4;
                                if (n8 >= this.mNumColumns) break;
                                object2 = this.mCache.mIndexedVariables[n8];
                                float f3 = object.variables.get((SolverVariable)object2);
                                if (f3 <= 0.0f) break block18;
                                n6 = n4;
                                n7 = 0;
                                n4 = n3;
                                n5 = n;
                                n3 = n6;
                                for (n = n7; n < 7; ++n) {
                                    block20 : {
                                        block19 : {
                                            f2 = object2.strengthVector[n] / f3;
                                            if (f2 < f && n == n3) break block19;
                                            n6 = n3;
                                            if (n <= n3) break block20;
                                        }
                                        n4 = n8;
                                        n5 = i;
                                        f = f2;
                                        n6 = n;
                                    }
                                    n3 = n6;
                                }
                                n = n4;
                                n4 = n3;
                                n3 = n;
                                n = n5;
                            }
                            ++n8;
                        } while (true);
                    }
                    n = n5;
                    n3 = n6;
                    f = f2;
                    n4 = n7;
                }
                if (n != -1) {
                    object = this.mRows[n];
                    object.variable.definitionId = -1;
                    if (sMetrics != null) {
                        object2 = sMetrics;
                        ++object2.pivots;
                    }
                    object.pivot(this.mCache.mIndexedVariables[n3]);
                    object.variable.definitionId = n;
                    object.variable.updateReferencesWithNewDefinition((ArrayRow)object);
                } else {
                    bl = true;
                }
                if (n2 > this.mNumColumns / 2) {
                    bl = true;
                }
                n = n2;
            }
            return n;
        }
        return 0;
    }

    private String getDisplaySize(int n) {
        int n2 = (n *= 4) / 1024;
        int n3 = n2 / 1024;
        if (n3 > 0) {
            StringBuilder stringBuilder = new StringBuilder();
            stringBuilder.append("");
            stringBuilder.append(n3);
            stringBuilder.append(" Mb");
            return stringBuilder.toString();
        }
        if (n2 > 0) {
            StringBuilder stringBuilder = new StringBuilder();
            stringBuilder.append("");
            stringBuilder.append(n2);
            stringBuilder.append(" Kb");
            return stringBuilder.toString();
        }
        StringBuilder stringBuilder = new StringBuilder();
        stringBuilder.append("");
        stringBuilder.append(n);
        stringBuilder.append(" bytes");
        return stringBuilder.toString();
    }

    private String getDisplayStrength(int n) {
        if (n == 1) {
            return "LOW";
        }
        if (n == 2) {
            return "MEDIUM";
        }
        if (n == 3) {
            return "HIGH";
        }
        if (n == 4) {
            return "HIGHEST";
        }
        if (n == 5) {
            return "EQUALITY";
        }
        if (n == 6) {
            return "FIXED";
        }
        return "NONE";
    }

    public static Metrics getMetrics() {
        return sMetrics;
    }

    private void increaseTableSize() {
        this.TABLE_SIZE *= 2;
        this.mRows = Arrays.copyOf(this.mRows, this.TABLE_SIZE);
        this.mCache.mIndexedVariables = Arrays.copyOf(this.mCache.mIndexedVariables, this.TABLE_SIZE);
        this.mAlreadyTestedCandidates = new boolean[this.TABLE_SIZE];
        this.mMaxColumns = this.TABLE_SIZE;
        this.mMaxRows = this.TABLE_SIZE;
        if (sMetrics != null) {
            Metrics metrics = sMetrics;
            ++metrics.tableSizeIncrease;
            LinearSystem.sMetrics.lastTableSize = LinearSystem.sMetrics.maxTableSize = Math.max(LinearSystem.sMetrics.maxTableSize, (long)this.TABLE_SIZE);
        }
    }

    private final int optimize(Row row, boolean bl) {
        int n;
        Object object;
        if (sMetrics != null) {
            object = sMetrics;
            ++object.optimize;
        }
        for (n = 0; n < this.mNumColumns; ++n) {
            this.mAlreadyTestedCandidates[n] = false;
        }
        boolean bl2 = false;
        n = 0;
        while (!bl2) {
            int n2;
            if (sMetrics != null) {
                object = sMetrics;
                ++object.iterations;
            }
            if ((n2 = n + 1) >= this.mNumColumns * 2) {
                return n2;
            }
            if (row.getKey() != null) {
                this.mAlreadyTestedCandidates[row.getKey().id] = true;
            }
            if ((object = row.getPivotCandidate(this, this.mAlreadyTestedCandidates)) != null) {
                if (this.mAlreadyTestedCandidates[object.id]) {
                    return n2;
                }
                this.mAlreadyTestedCandidates[object.id] = true;
            }
            if (object != null) {
                ArrayRow arrayRow;
                int n3 = -1;
                float f = Float.MAX_VALUE;
                for (n = 0; n < this.mNumRows; ++n) {
                    int n4;
                    float f2;
                    arrayRow = this.mRows[n];
                    if (arrayRow.variable.mType == SolverVariable.Type.UNRESTRICTED) {
                        n4 = n3;
                        f2 = f;
                    } else if (arrayRow.isSimpleDefinition) {
                        n4 = n3;
                        f2 = f;
                    } else {
                        n4 = n3;
                        f2 = f;
                        if (arrayRow.hasVariable((SolverVariable)object)) {
                            float f3 = arrayRow.variables.get((SolverVariable)object);
                            n4 = n3;
                            f2 = f;
                            if (f3 < 0.0f) {
                                f3 = (- arrayRow.constantValue) / f3;
                                n4 = n3;
                                f2 = f;
                                if (f3 < f) {
                                    n4 = n;
                                    f2 = f3;
                                }
                            }
                        }
                    }
                    n3 = n4;
                    f = f2;
                }
                if (n3 > -1) {
                    arrayRow = this.mRows[n3];
                    arrayRow.variable.definitionId = -1;
                    if (sMetrics != null) {
                        Metrics metrics = sMetrics;
                        ++metrics.pivots;
                    }
                    arrayRow.pivot((SolverVariable)object);
                    arrayRow.variable.definitionId = n3;
                    arrayRow.variable.updateReferencesWithNewDefinition(arrayRow);
                    n = n2;
                    continue;
                }
            }
            bl2 = true;
            n = n2;
        }
        return n;
    }

    private void releaseRows() {
        for (int i = 0; i < this.mRows.length; ++i) {
            ArrayRow arrayRow = this.mRows[i];
            if (arrayRow != null) {
                this.mCache.arrayRowPool.release(arrayRow);
            }
            this.mRows[i] = null;
        }
    }

    private final void updateRowFromVariables(ArrayRow arrayRow) {
        if (this.mNumRows > 0) {
            arrayRow.variables.updateFromSystem(arrayRow, this.mRows);
            if (arrayRow.variables.currentSize == 0) {
                arrayRow.isSimpleDefinition = true;
            }
        }
    }

    public void addCenterPoint(ConstraintWidget object, ConstraintWidget object2, float f, int n) {
        SolverVariable solverVariable = this.createObjectVariable(object.getAnchor(ConstraintAnchor.Type.LEFT));
        SolverVariable solverVariable2 = this.createObjectVariable(object.getAnchor(ConstraintAnchor.Type.TOP));
        SolverVariable solverVariable3 = this.createObjectVariable(object.getAnchor(ConstraintAnchor.Type.RIGHT));
        SolverVariable solverVariable4 = this.createObjectVariable(object.getAnchor(ConstraintAnchor.Type.BOTTOM));
        object = this.createObjectVariable(object2.getAnchor(ConstraintAnchor.Type.LEFT));
        SolverVariable solverVariable5 = this.createObjectVariable(object2.getAnchor(ConstraintAnchor.Type.TOP));
        SolverVariable solverVariable6 = this.createObjectVariable(object2.getAnchor(ConstraintAnchor.Type.RIGHT));
        object2 = this.createObjectVariable(object2.getAnchor(ConstraintAnchor.Type.BOTTOM));
        ArrayRow arrayRow = this.createRow();
        double d = f;
        double d2 = Math.sin(d);
        double d3 = n;
        arrayRow.createRowWithAngle(solverVariable2, solverVariable4, solverVariable5, (SolverVariable)object2, (float)(d2 * d3));
        this.addConstraint(arrayRow);
        object2 = this.createRow();
        object2.createRowWithAngle(solverVariable, solverVariable3, (SolverVariable)object, solverVariable6, (float)(Math.cos(d) * d3));
        this.addConstraint((ArrayRow)object2);
    }

    public void addCentering(SolverVariable solverVariable, SolverVariable solverVariable2, int n, float f, SolverVariable solverVariable3, SolverVariable solverVariable4, int n2, int n3) {
        ArrayRow arrayRow = this.createRow();
        arrayRow.createRowCentering(solverVariable, solverVariable2, n, f, solverVariable3, solverVariable4, n2);
        if (n3 != 6) {
            arrayRow.addError(this, n3);
        }
        this.addConstraint(arrayRow);
    }

    public void addConstraint(ArrayRow arrayRow) {
        Object object;
        if (arrayRow == null) {
            return;
        }
        if (sMetrics != null) {
            object = sMetrics;
            ++object.constraints;
            if (arrayRow.isSimpleDefinition) {
                object = sMetrics;
                ++object.simpleconstraints;
            }
        }
        if (this.mNumRows + 1 >= this.mMaxRows || this.mNumColumns + 1 >= this.mMaxColumns) {
            this.increaseTableSize();
        }
        boolean bl = false;
        boolean bl2 = false;
        if (!arrayRow.isSimpleDefinition) {
            this.updateRowFromVariables(arrayRow);
            if (arrayRow.isEmpty()) {
                return;
            }
            arrayRow.ensurePositiveConstant();
            bl = bl2;
            if (arrayRow.chooseSubject(this)) {
                arrayRow.variable = object = this.createExtraVariable();
                this.addRow(arrayRow);
                this.mTempGoal.initFromRow(arrayRow);
                this.optimize(this.mTempGoal, true);
                if (object.definitionId == -1) {
                    if (arrayRow.variable == object && (object = arrayRow.pickPivot((SolverVariable)object)) != null) {
                        if (sMetrics != null) {
                            Metrics metrics = sMetrics;
                            ++metrics.pivots;
                        }
                        arrayRow.pivot((SolverVariable)object);
                    }
                    if (!arrayRow.isSimpleDefinition) {
                        arrayRow.variable.updateReferencesWithNewDefinition(arrayRow);
                    }
                    --this.mNumRows;
                }
                bl = true;
            }
            if (!arrayRow.hasKeyVariable()) {
                return;
            }
        }
        if (!bl) {
            this.addRow(arrayRow);
        }
    }

    public ArrayRow addEquality(SolverVariable solverVariable, SolverVariable solverVariable2, int n, int n2) {
        ArrayRow arrayRow = this.createRow();
        arrayRow.createRowEquals(solverVariable, solverVariable2, n);
        if (n2 != 6) {
            arrayRow.addError(this, n2);
        }
        this.addConstraint(arrayRow);
        return arrayRow;
    }

    public void addEquality(SolverVariable solverVariable, int n) {
        int n2 = solverVariable.definitionId;
        if (solverVariable.definitionId != -1) {
            ArrayRow arrayRow = this.mRows[n2];
            if (arrayRow.isSimpleDefinition) {
                arrayRow.constantValue = n;
                return;
            }
            if (arrayRow.variables.currentSize == 0) {
                arrayRow.isSimpleDefinition = true;
                arrayRow.constantValue = n;
                return;
            }
            arrayRow = this.createRow();
            arrayRow.createRowEquals(solverVariable, n);
            this.addConstraint(arrayRow);
            return;
        }
        ArrayRow arrayRow = this.createRow();
        arrayRow.createRowDefinition(solverVariable, n);
        this.addConstraint(arrayRow);
    }

    public void addEquality(SolverVariable solverVariable, int n, int n2) {
        int n3 = solverVariable.definitionId;
        if (solverVariable.definitionId != -1) {
            ArrayRow arrayRow = this.mRows[n3];
            if (arrayRow.isSimpleDefinition) {
                arrayRow.constantValue = n;
                return;
            }
            arrayRow = this.createRow();
            arrayRow.createRowEquals(solverVariable, n);
            arrayRow.addError(this, n2);
            this.addConstraint(arrayRow);
            return;
        }
        ArrayRow arrayRow = this.createRow();
        arrayRow.createRowDefinition(solverVariable, n);
        arrayRow.addError(this, n2);
        this.addConstraint(arrayRow);
    }

    public void addGreaterBarrier(SolverVariable solverVariable, SolverVariable solverVariable2, boolean bl) {
        ArrayRow arrayRow = this.createRow();
        SolverVariable solverVariable3 = this.createSlackVariable();
        solverVariable3.strength = 0;
        arrayRow.createRowGreaterThan(solverVariable, solverVariable2, solverVariable3, 0);
        if (bl) {
            this.addSingleError(arrayRow, (int)(arrayRow.variables.get(solverVariable3) * -1.0f), 1);
        }
        this.addConstraint(arrayRow);
    }

    public void addGreaterThan(SolverVariable solverVariable, int n) {
        ArrayRow arrayRow = this.createRow();
        SolverVariable solverVariable2 = this.createSlackVariable();
        solverVariable2.strength = 0;
        arrayRow.createRowGreaterThan(solverVariable, n, solverVariable2);
        this.addConstraint(arrayRow);
    }

    public void addGreaterThan(SolverVariable solverVariable, SolverVariable solverVariable2, int n, int n2) {
        ArrayRow arrayRow = this.createRow();
        SolverVariable solverVariable3 = this.createSlackVariable();
        solverVariable3.strength = 0;
        arrayRow.createRowGreaterThan(solverVariable, solverVariable2, solverVariable3, n);
        if (n2 != 6) {
            this.addSingleError(arrayRow, (int)(arrayRow.variables.get(solverVariable3) * -1.0f), n2);
        }
        this.addConstraint(arrayRow);
    }

    public void addLowerBarrier(SolverVariable solverVariable, SolverVariable solverVariable2, boolean bl) {
        ArrayRow arrayRow = this.createRow();
        SolverVariable solverVariable3 = this.createSlackVariable();
        solverVariable3.strength = 0;
        arrayRow.createRowLowerThan(solverVariable, solverVariable2, solverVariable3, 0);
        if (bl) {
            this.addSingleError(arrayRow, (int)(arrayRow.variables.get(solverVariable3) * -1.0f), 1);
        }
        this.addConstraint(arrayRow);
    }

    public void addLowerThan(SolverVariable solverVariable, SolverVariable solverVariable2, int n, int n2) {
        ArrayRow arrayRow = this.createRow();
        SolverVariable solverVariable3 = this.createSlackVariable();
        solverVariable3.strength = 0;
        arrayRow.createRowLowerThan(solverVariable, solverVariable2, solverVariable3, n);
        if (n2 != 6) {
            this.addSingleError(arrayRow, (int)(arrayRow.variables.get(solverVariable3) * -1.0f), n2);
        }
        this.addConstraint(arrayRow);
    }

    public void addRatio(SolverVariable solverVariable, SolverVariable solverVariable2, SolverVariable solverVariable3, SolverVariable solverVariable4, float f, int n) {
        ArrayRow arrayRow = this.createRow();
        arrayRow.createRowDimensionRatio(solverVariable, solverVariable2, solverVariable3, solverVariable4, f);
        if (n != 6) {
            arrayRow.addError(this, n);
        }
        this.addConstraint(arrayRow);
    }

    void addSingleError(ArrayRow arrayRow, int n, int n2) {
        arrayRow.addSingleError(this.createErrorVariable(n2, null), n);
    }

    public SolverVariable createErrorVariable(int n, String object) {
        if (sMetrics != null) {
            Metrics metrics = sMetrics;
            ++metrics.errors;
        }
        if (this.mNumColumns + 1 >= this.mMaxColumns) {
            this.increaseTableSize();
        }
        object = this.acquireSolverVariable(SolverVariable.Type.ERROR, (String)object);
        ++this.mVariablesID;
        ++this.mNumColumns;
        object.id = this.mVariablesID;
        object.strength = n;
        this.mCache.mIndexedVariables[this.mVariablesID] = object;
        this.mGoal.addError((SolverVariable)object);
        return object;
    }

    public SolverVariable createExtraVariable() {
        Object object;
        if (sMetrics != null) {
            object = sMetrics;
            ++object.extravariables;
        }
        if (this.mNumColumns + 1 >= this.mMaxColumns) {
            this.increaseTableSize();
        }
        object = this.acquireSolverVariable(SolverVariable.Type.SLACK, null);
        ++this.mVariablesID;
        ++this.mNumColumns;
        object.id = this.mVariablesID;
        this.mCache.mIndexedVariables[this.mVariablesID] = object;
        return object;
    }

    public SolverVariable createObjectVariable(Object object) {
        Object object2;
        block7 : {
            block8 : {
                object2 = null;
                if (object == null) {
                    return null;
                }
                if (this.mNumColumns + 1 >= this.mMaxColumns) {
                    this.increaseTableSize();
                }
                if (!(object instanceof ConstraintAnchor)) break block7;
                ConstraintAnchor constraintAnchor = (ConstraintAnchor)object;
                object = object2 = constraintAnchor.getSolverVariable();
                if (object2 == null) {
                    constraintAnchor.resetSolverVariable(this.mCache);
                    object = constraintAnchor.getSolverVariable();
                }
                if (object.id == -1 || object.id > this.mVariablesID) break block8;
                object2 = object;
                if (this.mCache.mIndexedVariables[object.id] != null) break block7;
            }
            if (object.id != -1) {
                object.reset();
            }
            ++this.mVariablesID;
            ++this.mNumColumns;
            object.id = this.mVariablesID;
            object.mType = SolverVariable.Type.UNRESTRICTED;
            this.mCache.mIndexedVariables[this.mVariablesID] = object;
            object2 = object;
        }
        return object2;
    }

    public ArrayRow createRow() {
        ArrayRow arrayRow = this.mCache.arrayRowPool.acquire();
        if (arrayRow == null) {
            arrayRow = new ArrayRow(this.mCache);
        } else {
            arrayRow.reset();
        }
        SolverVariable.increaseErrorId();
        return arrayRow;
    }

    public SolverVariable createSlackVariable() {
        Object object;
        if (sMetrics != null) {
            object = sMetrics;
            ++object.slackvariables;
        }
        if (this.mNumColumns + 1 >= this.mMaxColumns) {
            this.increaseTableSize();
        }
        object = this.acquireSolverVariable(SolverVariable.Type.SLACK, null);
        ++this.mVariablesID;
        ++this.mNumColumns;
        object.id = this.mVariablesID;
        this.mCache.mIndexedVariables[this.mVariablesID] = object;
        return object;
    }

    void displayReadableRows() {
        CharSequence charSequence;
        this.displaySolverVariables();
        String string2 = " #  ";
        for (int i = 0; i < this.mNumRows; ++i) {
            charSequence = new StringBuilder();
            charSequence.append(string2);
            charSequence.append(this.mRows[i].toReadableString());
            string2 = charSequence.toString();
            charSequence = new StringBuilder();
            charSequence.append(string2);
            charSequence.append("\n #  ");
            string2 = charSequence.toString();
        }
        charSequence = string2;
        if (this.mGoal != null) {
            charSequence = new StringBuilder();
            charSequence.append(string2);
            charSequence.append(this.mGoal);
            charSequence.append("\n");
            charSequence = charSequence.toString();
        }
        System.out.println((String)charSequence);
    }

    void displaySystemInformations() {
        int n;
        int n2;
        int n3 = 0;
        for (n2 = 0; n2 < this.TABLE_SIZE; ++n2) {
            n = n3;
            if (this.mRows[n2] != null) {
                n = n3 + this.mRows[n2].sizeInBytes();
            }
            n3 = n;
        }
        n = 0;
        for (n2 = 0; n2 < this.mNumRows; ++n2) {
            int n4 = n;
            if (this.mRows[n2] != null) {
                n4 = n + this.mRows[n2].sizeInBytes();
            }
            n = n4;
        }
        PrintStream printStream = System.out;
        StringBuilder stringBuilder = new StringBuilder();
        stringBuilder.append("Linear System -> Table size: ");
        stringBuilder.append(this.TABLE_SIZE);
        stringBuilder.append(" (");
        stringBuilder.append(this.getDisplaySize(this.TABLE_SIZE * this.TABLE_SIZE));
        stringBuilder.append(") -- row sizes: ");
        stringBuilder.append(this.getDisplaySize(n3));
        stringBuilder.append(", actual size: ");
        stringBuilder.append(this.getDisplaySize(n));
        stringBuilder.append(" rows: ");
        stringBuilder.append(this.mNumRows);
        stringBuilder.append("/");
        stringBuilder.append(this.mMaxRows);
        stringBuilder.append(" cols: ");
        stringBuilder.append(this.mNumColumns);
        stringBuilder.append("/");
        stringBuilder.append(this.mMaxColumns);
        stringBuilder.append(" ");
        stringBuilder.append(0);
        stringBuilder.append(" occupied cells, ");
        stringBuilder.append(this.getDisplaySize(0));
        printStream.println(stringBuilder.toString());
    }

    public void displayVariablesReadableRows() {
        CharSequence charSequence;
        this.displaySolverVariables();
        CharSequence charSequence2 = "";
        for (int i = 0; i < this.mNumRows; ++i) {
            charSequence = charSequence2;
            if (this.mRows[i].variable.mType == SolverVariable.Type.UNRESTRICTED) {
                charSequence = new StringBuilder();
                charSequence.append((String)charSequence2);
                charSequence.append(this.mRows[i].toReadableString());
                charSequence2 = charSequence.toString();
                charSequence = new StringBuilder();
                charSequence.append((String)charSequence2);
                charSequence.append("\n");
                charSequence = charSequence.toString();
            }
            charSequence2 = charSequence;
        }
        charSequence = new StringBuilder();
        charSequence.append((String)charSequence2);
        charSequence.append(this.mGoal);
        charSequence.append("\n");
        charSequence2 = charSequence.toString();
        System.out.println((String)charSequence2);
    }

    public void fillMetrics(Metrics metrics) {
        sMetrics = metrics;
    }

    public Cache getCache() {
        return this.mCache;
    }

    Row getGoal() {
        return this.mGoal;
    }

    public int getMemoryUsed() {
        int n = 0;
        for (int i = 0; i < this.mNumRows; ++i) {
            int n2 = n;
            if (this.mRows[i] != null) {
                n2 = n + this.mRows[i].sizeInBytes();
            }
            n = n2;
        }
        return n;
    }

    public int getNumEquations() {
        return this.mNumRows;
    }

    public int getNumVariables() {
        return this.mVariablesID;
    }

    public int getObjectVariableValue(Object object) {
        if ((object = ((ConstraintAnchor)object).getSolverVariable()) != null) {
            return (int)(object.computedValue + 0.5f);
        }
        return 0;
    }

    ArrayRow getRow(int n) {
        return this.mRows[n];
    }

    float getValueFor(String object) {
        if ((object = this.getVariable((String)object, SolverVariable.Type.UNRESTRICTED)) == null) {
            return 0.0f;
        }
        return object.computedValue;
    }

    SolverVariable getVariable(String string2, SolverVariable.Type type) {
        SolverVariable solverVariable;
        if (this.mVariables == null) {
            this.mVariables = new HashMap();
        }
        SolverVariable solverVariable2 = solverVariable = this.mVariables.get(string2);
        if (solverVariable == null) {
            solverVariable2 = this.createVariable(string2, type);
        }
        return solverVariable2;
    }

    public void minimize() throws Exception {
        Metrics metrics;
        if (sMetrics != null) {
            metrics = sMetrics;
            ++metrics.minimize;
        }
        if (this.graphOptimizer) {
            int n;
            block6 : {
                if (sMetrics != null) {
                    metrics = sMetrics;
                    ++metrics.graphOptimizer;
                }
                int n2 = 0;
                for (n = 0; n < this.mNumRows; ++n) {
                    if (this.mRows[n].isSimpleDefinition) continue;
                    n = n2;
                    break block6;
                }
                n = 1;
            }
            if (n == 0) {
                this.minimizeGoal(this.mGoal);
                return;
            }
            if (sMetrics != null) {
                metrics = sMetrics;
                ++metrics.fullySolved;
            }
            this.computeValues();
            return;
        }
        this.minimizeGoal(this.mGoal);
    }

    void minimizeGoal(Row row) throws Exception {
        if (sMetrics != null) {
            Metrics metrics = sMetrics;
            ++metrics.minimizeGoal;
            LinearSystem.sMetrics.maxVariables = Math.max(LinearSystem.sMetrics.maxVariables, (long)this.mNumColumns);
            LinearSystem.sMetrics.maxRows = Math.max(LinearSystem.sMetrics.maxRows, (long)this.mNumRows);
        }
        this.updateRowFromVariables((ArrayRow)row);
        this.enforceBFS(row);
        this.optimize(row, false);
        this.computeValues();
    }

    public void reset() {
        int n;
        for (n = 0; n < this.mCache.mIndexedVariables.length; ++n) {
            SolverVariable solverVariable = this.mCache.mIndexedVariables[n];
            if (solverVariable == null) continue;
            solverVariable.reset();
        }
        this.mCache.solverVariablePool.releaseAll(this.mPoolVariables, this.mPoolVariablesCount);
        this.mPoolVariablesCount = 0;
        Arrays.fill(this.mCache.mIndexedVariables, null);
        if (this.mVariables != null) {
            this.mVariables.clear();
        }
        this.mVariablesID = 0;
        this.mGoal.clear();
        this.mNumColumns = 1;
        for (n = 0; n < this.mNumRows; ++n) {
            this.mRows[n].used = false;
        }
        this.releaseRows();
        this.mNumRows = 0;
    }

    static interface Row {
        public void addError(SolverVariable var1);

        public void clear();

        public SolverVariable getKey();

        public SolverVariable getPivotCandidate(LinearSystem var1, boolean[] var2);

        public void initFromRow(Row var1);

        public boolean isEmpty();
    }

}

