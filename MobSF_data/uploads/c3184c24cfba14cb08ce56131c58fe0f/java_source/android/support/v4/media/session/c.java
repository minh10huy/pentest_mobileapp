/*
 * Decompiled with CFR 0_132.
 * 
 * Could not load the following classes:
 *  android.content.BroadcastReceiver
 *  android.content.BroadcastReceiver$PendingResult
 *  android.content.ComponentName
 *  android.content.Context
 *  android.content.Intent
 *  android.content.pm.ActivityInfo
 *  android.content.pm.PackageManager
 *  android.content.pm.ResolveInfo
 *  android.content.pm.ServiceInfo
 *  android.os.Build
 *  android.os.Build$VERSION
 *  android.os.Bundle
 *  android.os.Parcelable
 *  android.os.RemoteException
 *  android.util.Log
 *  android.view.KeyEvent
 */
package android.support.v4.media.session;

import android.content.BroadcastReceiver;
import android.content.ComponentName;
import android.content.Context;
import android.content.Intent;
import android.content.pm.ActivityInfo;
import android.content.pm.PackageManager;
import android.content.pm.ResolveInfo;
import android.content.pm.ServiceInfo;
import android.os.Build;
import android.os.Bundle;
import android.os.Parcelable;
import android.os.RemoteException;
import android.support.v4.media.MediaBrowserCompat;
import android.support.v4.media.session.MediaControllerCompat;
import android.support.v4.media.session.MediaSessionCompat;
import android.util.Log;
import android.view.KeyEvent;
import java.util.List;

public class c
extends BroadcastReceiver {
    static ComponentName a(Context object) {
        Intent intent = new Intent("android.intent.action.MEDIA_BUTTON");
        intent.setPackage(object.getPackageName());
        object = object.getPackageManager().queryBroadcastReceivers(intent, 0);
        if (object.size() == 1) {
            object = (ResolveInfo)object.get(0);
            return new ComponentName(object.activityInfo.packageName, object.activityInfo.name);
        }
        if (object.size() > 1) {
            Log.w((String)"MediaButtonReceiver", (String)"More than one BroadcastReceiver that handles android.intent.action.MEDIA_BUTTON was found, returning null.");
        }
        return null;
    }

    private static ComponentName a(Context object, String string2) {
        Object object2 = object.getPackageManager();
        Intent intent = new Intent(string2);
        intent.setPackage(object.getPackageName());
        object = object2.queryIntentServices(intent, 0);
        if (object.size() == 1) {
            object = (ResolveInfo)object.get(0);
            return new ComponentName(object.serviceInfo.packageName, object.serviceInfo.name);
        }
        if (object.isEmpty()) {
            return null;
        }
        object2 = new StringBuilder();
        object2.append("Expected 1 service that handles ");
        object2.append(string2);
        object2.append(", found ");
        object2.append(object.size());
        throw new IllegalStateException(object2.toString());
    }

    private static void a(Context context, Intent intent) {
        if (Build.VERSION.SDK_INT >= 26) {
            context.startForegroundService(intent);
            return;
        }
        context.startService(intent);
    }

    public void onReceive(Context object, Intent object2) {
        if (object2 != null && "android.intent.action.MEDIA_BUTTON".equals(object2.getAction()) && object2.hasExtra("android.intent.extra.KEY_EVENT")) {
            ComponentName componentName = c.a((Context)object, "android.intent.action.MEDIA_BUTTON");
            if (componentName != null) {
                object2.setComponent(componentName);
                c.a((Context)object, (Intent)object2);
                return;
            }
            componentName = c.a((Context)object, "android.media.browse.MediaBrowserService");
            if (componentName != null) {
                BroadcastReceiver.PendingResult pendingResult = this.goAsync();
                object = object.getApplicationContext();
                object2 = new a((Context)object, (Intent)object2, pendingResult);
                object = new MediaBrowserCompat((Context)object, componentName, (MediaBrowserCompat.b)object2, null);
                object2.a((MediaBrowserCompat)object);
                object.a();
                return;
            }
            throw new IllegalStateException("Could not find any Service that handles android.intent.action.MEDIA_BUTTON or implements a media browser service.");
        }
        object = new StringBuilder();
        object.append("Ignore unsupported intent: ");
        object.append(object2);
        Log.d((String)"MediaButtonReceiver", (String)object.toString());
    }

    private static class a
    extends MediaBrowserCompat.b {
        private final Context c;
        private final Intent d;
        private final BroadcastReceiver.PendingResult e;
        private MediaBrowserCompat f;

        a(Context context, Intent intent, BroadcastReceiver.PendingResult pendingResult) {
            this.c = context;
            this.d = intent;
            this.e = pendingResult;
        }

        private void d() {
            this.f.b();
            this.e.finish();
        }

        @Override
        public void a() {
            try {
                new MediaControllerCompat(this.c, this.f.c()).a((KeyEvent)this.d.getParcelableExtra("android.intent.extra.KEY_EVENT"));
            }
            catch (RemoteException remoteException) {
                Log.e((String)"MediaButtonReceiver", (String)"Failed to create a media controller", (Throwable)remoteException);
            }
            this.d();
        }

        void a(MediaBrowserCompat mediaBrowserCompat) {
            this.f = mediaBrowserCompat;
        }

        @Override
        public void b() {
            this.d();
        }

        @Override
        public void c() {
            this.d();
        }
    }

}

