/*
 * Decompiled with CFR 0_132.
 * 
 * Could not load the following classes:
 *  android.content.Context
 *  android.content.res.Configuration
 *  android.content.res.Resources
 *  android.graphics.drawable.Drawable
 *  android.os.IBinder
 *  android.util.AttributeSet
 *  android.util.DisplayMetrics
 *  android.util.SparseBooleanArray
 *  android.view.Menu
 *  android.view.MenuItem
 *  android.view.View
 *  android.view.View$MeasureSpec
 *  android.view.View$OnTouchListener
 *  android.view.ViewGroup
 *  android.view.ViewGroup$LayoutParams
 *  android.view.ViewParent
 */
package android.support.v7.widget;

import android.content.Context;
import android.content.res.Configuration;
import android.content.res.Resources;
import android.graphics.drawable.Drawable;
import android.os.IBinder;
import android.support.v4.view.c;
import android.support.v7.a.a;
import android.support.v7.view.menu.ActionMenuItemView;
import android.support.v7.view.menu.h;
import android.support.v7.view.menu.j;
import android.support.v7.view.menu.m;
import android.support.v7.view.menu.n;
import android.support.v7.view.menu.o;
import android.support.v7.view.menu.p;
import android.support.v7.view.menu.s;
import android.support.v7.view.menu.u;
import android.support.v7.widget.ActionMenuView;
import android.support.v7.widget.AppCompatImageView;
import android.support.v7.widget.al;
import android.support.v7.widget.bi;
import android.util.AttributeSet;
import android.util.DisplayMetrics;
import android.util.SparseBooleanArray;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.view.ViewGroup;
import android.view.ViewParent;
import java.util.ArrayList;

class d
extends android.support.v7.view.menu.b
implements c.a {
    private b A;
    d g;
    e h;
    a i;
    c j;
    final f k = new f();
    int l;
    private Drawable m;
    private boolean n;
    private boolean o;
    private boolean p;
    private int q;
    private int r;
    private int s;
    private boolean t;
    private boolean u;
    private boolean v;
    private boolean w;
    private int x;
    private final SparseBooleanArray y = new SparseBooleanArray();
    private View z;

    public d(Context context) {
        super(context, a.g.abc_action_menu_layout, a.g.abc_action_menu_item_layout);
    }

    private View a(MenuItem menuItem) {
        ViewGroup viewGroup = (ViewGroup)this.f;
        if (viewGroup == null) {
            return null;
        }
        int n2 = viewGroup.getChildCount();
        for (int i2 = 0; i2 < n2; ++i2) {
            View view = viewGroup.getChildAt(i2);
            if (!(view instanceof p.a) || ((p.a)view).getItemData() != menuItem) continue;
            return view;
        }
        return null;
    }

    @Override
    public p a(ViewGroup object) {
        p p2 = this.f;
        if (p2 != (object = super.a((ViewGroup)object))) {
            ((ActionMenuView)object).setPresenter(this);
        }
        return object;
    }

    @Override
    public View a(j object, View view, ViewGroup viewGroup) {
        View view2 = object.getActionView();
        if (view2 == null || object.n()) {
            view2 = super.a((j)object, view, viewGroup);
        }
        int n2 = object.isActionViewExpanded() ? 8 : 0;
        view2.setVisibility(n2);
        object = (ActionMenuView)viewGroup;
        view = view2.getLayoutParams();
        if (!object.checkLayoutParams((ViewGroup.LayoutParams)view)) {
            view2.setLayoutParams((ViewGroup.LayoutParams)object.a((ViewGroup.LayoutParams)view));
        }
        return view2;
    }

    @Override
    public void a(Context object, h h2) {
        super.a((Context)object, h2);
        h2 = object.getResources();
        object = android.support.v7.view.a.a((Context)object);
        if (!this.p) {
            this.o = object.b();
        }
        if (!this.v) {
            this.q = object.c();
        }
        if (!this.t) {
            this.s = object.a();
        }
        int n2 = this.q;
        if (this.o) {
            if (this.g == null) {
                this.g = new d(this.a);
                if (this.n) {
                    this.g.setImageDrawable(this.m);
                    this.m = null;
                    this.n = false;
                }
                int n3 = View.MeasureSpec.makeMeasureSpec((int)0, (int)0);
                this.g.measure(n3, n3);
            }
            n2 -= this.g.getMeasuredWidth();
        } else {
            this.g = null;
        }
        this.r = n2;
        this.x = (int)(h2.getDisplayMetrics().density * 56.0f);
        this.z = null;
    }

    public void a(Configuration configuration) {
        if (!this.t) {
            this.s = android.support.v7.view.a.a(this.b).a();
        }
        if (this.c != null) {
            this.c.b(true);
        }
    }

    public void a(Drawable drawable2) {
        if (this.g != null) {
            this.g.setImageDrawable(drawable2);
            return;
        }
        this.n = true;
        this.m = drawable2;
    }

    @Override
    public void a(h h2, boolean bl2) {
        this.f();
        super.a(h2, bl2);
    }

    @Override
    public void a(j object, p.a a2) {
        a2.a((j)object, 0);
        object = (ActionMenuView)this.f;
        a2 = (ActionMenuItemView)a2;
        a2.setItemInvoker((h.b)object);
        if (this.A == null) {
            this.A = new b();
        }
        a2.setPopupCallback(this.A);
    }

    public void a(ActionMenuView actionMenuView) {
        this.f = actionMenuView;
        actionMenuView.a(this.c);
    }

    @Override
    public void a(boolean bl2) {
        if (bl2) {
            super.a((u)null);
            return;
        }
        if (this.c != null) {
            this.c.a(false);
        }
    }

    @Override
    public boolean a(int n2, j j2) {
        return j2.j();
    }

    @Override
    public boolean a(u u2) {
        boolean bl2 = u2.hasVisibleItems();
        boolean bl3 = false;
        if (!bl2) {
            return false;
        }
        u u3 = u2;
        while (u3.s() != this.c) {
            u3 = (u)u3.s();
        }
        if ((u3 = this.a(u3.getItem())) == null) {
            return false;
        }
        this.l = u2.getItem().getItemId();
        int n2 = u2.size();
        int n3 = 0;
        do {
            bl2 = bl3;
            if (n3 >= n2) break;
            MenuItem menuItem = u2.getItem(n3);
            if (menuItem.isVisible() && menuItem.getIcon() != null) {
                bl2 = true;
                break;
            }
            ++n3;
        } while (true);
        this.i = new a(this.b, u2, (View)u3);
        this.i.a(bl2);
        this.i.a();
        super.a(u2);
        return true;
    }

    @Override
    public boolean a(ViewGroup viewGroup, int n2) {
        if (viewGroup.getChildAt(n2) == this.g) {
            return false;
        }
        return super.a(viewGroup, n2);
    }

    @Override
    public void b(boolean bl2) {
        int n2;
        int n3;
        super.b(bl2);
        ((View)this.f).requestLayout();
        Object object = this.c;
        int n4 = 0;
        if (object != null) {
            object = this.c.k();
            n3 = object.size();
            for (n2 = 0; n2 < n3; ++n2) {
                android.support.v4.view.c c2 = object.get(n2).a();
                if (c2 == null) continue;
                c2.a(this);
            }
        }
        object = this.c != null ? this.c.l() : null;
        n2 = n4;
        if (this.o) {
            n2 = n4;
            if (object != null) {
                n3 = object.size();
                if (n3 == 1) {
                    n2 = ((j)object.get(0)).isActionViewExpanded() ^ true;
                } else {
                    n2 = n4;
                    if (n3 > 0) {
                        n2 = 1;
                    }
                }
            }
        }
        if (n2 != 0) {
            if (this.g == null) {
                this.g = new d(this.a);
            }
            if ((object = (ViewGroup)this.g.getParent()) != this.f) {
                if (object != null) {
                    object.removeView((View)this.g);
                }
                object = (ActionMenuView)this.f;
                object.addView((View)this.g, (ViewGroup.LayoutParams)object.c());
            }
        } else if (this.g != null && this.g.getParent() == this.f) {
            ((ViewGroup)this.f).removeView((View)this.g);
        }
        ((ActionMenuView)this.f).setOverflowReserved(this.o);
    }

    /*
     * Enabled aggressive block sorting
     */
    @Override
    public boolean b() {
        int n2;
        int n3;
        int n4;
        int n5;
        Object object;
        ArrayList<j> arrayList;
        j j2;
        int n6;
        ViewGroup viewGroup;
        int n7;
        int n8;
        int n9;
        int n10;
        block39 : {
            block40 : {
                object = this;
                if (object.c != null) {
                    arrayList = object.c.i();
                    n3 = arrayList.size();
                } else {
                    arrayList = null;
                    n3 = 0;
                }
                n5 = object.s;
                n9 = object.r;
                n7 = View.MeasureSpec.makeMeasureSpec((int)0, (int)0);
                viewGroup = (ViewGroup)object.f;
                n8 = 0;
                n2 = 0;
                n6 = 0;
                for (n4 = 0; n4 < n3; ++n4) {
                    j2 = arrayList.get(n4);
                    if (j2.l()) {
                        ++n8;
                    } else if (j2.k()) {
                        ++n6;
                    } else {
                        n2 = 1;
                    }
                    n10 = n5;
                    if (object.w) {
                        n10 = n5;
                        if (j2.isActionViewExpanded()) {
                            n10 = 0;
                        }
                    }
                    n5 = n10;
                }
                n4 = n5;
                if (!object.o) break block39;
                if (n2 != 0) break block40;
                n4 = n5;
                if (n6 + n8 <= n5) break block39;
            }
            n4 = n5 - 1;
        }
        n5 = n4 - n8;
        j2 = object.y;
        j2.clear();
        if (object.u) {
            n4 = n9 / object.x;
            n6 = object.x;
            n8 = object.x;
            n2 = n9 % n6 / n4 + n8;
        } else {
            n4 = 0;
            n2 = 0;
        }
        n8 = n9;
        n9 = 0;
        n6 = 0;
        n10 = n3;
        do {
            View view;
            object = this;
            if (n9 >= n10) {
                return true;
            }
            j j3 = arrayList.get(n9);
            if (j3.l()) {
                view = object.a(j3, object.z, viewGroup);
                if (object.z == null) {
                    object.z = view;
                }
                if (object.u) {
                    n4 -= ActionMenuView.a(view, n2, n4, n7, 0);
                } else {
                    view.measure(n7, n7);
                }
                n3 = view.getMeasuredWidth();
                n8 -= n3;
                if (n6 == 0) {
                    n6 = n3;
                }
                if ((n3 = j3.getGroupId()) != 0) {
                    j2.put(n3, true);
                }
                j3.d(true);
            } else if (j3.k()) {
                int n11;
                int n12 = j3.getGroupId();
                boolean bl2 = j2.get(n12);
                int n13 = !(n5 <= 0 && !bl2 || n8 <= 0 || object.u && n4 <= 0) ? 1 : 0;
                if (n13 != 0) {
                    view = object.a(j3, object.z, viewGroup);
                    if (object.z == null) {
                        object.z = view;
                    }
                    if (object.u) {
                        n11 = ActionMenuView.a(view, n2, n4, n7, 0);
                        n4 = n3 = n4 - n11;
                        if (n11 == 0) {
                            n13 = 0;
                            n4 = n3;
                        }
                    } else {
                        view.measure(n7, n7);
                    }
                    n11 = view.getMeasuredWidth();
                    n8 -= n11;
                    n3 = n6;
                    if (n6 == 0) {
                        n3 = n11;
                    }
                    n6 = (object.u ? n8 >= 0 : n8 + n3 > 0) ? 1 : 0;
                    n13 &= n6;
                    n6 = n3;
                }
                if (n13 != 0 && n12 != 0) {
                    j2.put(n12, true);
                    n3 = n5;
                } else {
                    n3 = n5;
                    if (bl2) {
                        j2.put(n12, false);
                        n11 = 0;
                        do {
                            n3 = n5;
                            if (n11 >= n9) break;
                            object = arrayList.get(n11);
                            n3 = n5;
                            if (object.getGroupId() == n12) {
                                n3 = n5;
                                if (object.j()) {
                                    n3 = n5 + 1;
                                }
                                object.d(false);
                            }
                            ++n11;
                            n5 = n3;
                        } while (true);
                    }
                }
                n5 = n3;
                if (n13 != 0) {
                    n5 = n3 - 1;
                }
                j3.d((boolean)n13);
            } else {
                j3.d(false);
            }
            ++n9;
        } while (true);
    }

    public Drawable c() {
        if (this.g != null) {
            return this.g.getDrawable();
        }
        if (this.n) {
            return this.m;
        }
        return null;
    }

    public void c(boolean bl2) {
        this.o = bl2;
        this.p = true;
    }

    public void d(boolean bl2) {
        this.w = bl2;
    }

    public boolean d() {
        if (this.o && !this.h() && this.c != null && this.f != null && this.j == null && !this.c.l().isEmpty()) {
            this.j = new c(new e(this.b, this.c, (View)this.g, true));
            ((View)this.f).post((Runnable)this.j);
            super.a((u)null);
            return true;
        }
        return false;
    }

    public boolean e() {
        if (this.j != null && this.f != null) {
            ((View)this.f).removeCallbacks((Runnable)this.j);
            this.j = null;
            return true;
        }
        e e2 = this.h;
        if (e2 != null) {
            e2.d();
            return true;
        }
        return false;
    }

    public boolean f() {
        return this.e() | this.g();
    }

    public boolean g() {
        if (this.i != null) {
            this.i.d();
            return true;
        }
        return false;
    }

    public boolean h() {
        if (this.h != null && this.h.f()) {
            return true;
        }
        return false;
    }

    public boolean i() {
        if (this.j == null && !this.h()) {
            return false;
        }
        return true;
    }

    private class a
    extends n {
        public a(Context object, u u2, View view) {
            super((Context)object, u2, view, false, a.a.actionOverflowMenuStyle);
            if (!((j)u2.getItem()).j()) {
                object = d.this.g == null ? (View)d.this.f : d.this.g;
                this.a((View)object);
            }
            this.a(d.this.k);
        }

        @Override
        protected void e() {
            d.this.i = null;
            d.this.l = 0;
            super.e();
        }
    }

    private class b
    extends ActionMenuItemView.b {
        b() {
        }

        @Override
        public s a() {
            if (d.this.i != null) {
                return d.this.i.b();
            }
            return null;
        }
    }

    private class c
    implements Runnable {
        private e b;

        public c(e e2) {
            this.b = e2;
        }

        @Override
        public void run() {
            View view;
            if (d.this.c != null) {
                d.this.c.f();
            }
            if ((view = (View)d.this.f) != null && view.getWindowToken() != null && this.b.c()) {
                d.this.h = this.b;
            }
            d.this.j = null;
        }
    }

    private class d
    extends AppCompatImageView
    implements ActionMenuView.a {
        private final float[] b;

        public d(Context context) {
            super(context, null, a.a.actionOverflowButtonStyle);
            this.b = new float[2];
            this.setClickable(true);
            this.setFocusable(true);
            this.setVisibility(0);
            this.setEnabled(true);
            bi.a((View)this, this.getContentDescription());
            this.setOnTouchListener((View.OnTouchListener)new al((View)this, d.this){
                final /* synthetic */ d a;
                {
                    this.a = d3;
                    super(view);
                }

                @Override
                public s a() {
                    if (d.this.h == null) {
                        return null;
                    }
                    return d.this.h.b();
                }

                @Override
                public boolean b() {
                    d.this.d();
                    return true;
                }

                @Override
                public boolean c() {
                    if (d.this.j != null) {
                        return false;
                    }
                    d.this.e();
                    return true;
                }
            });
        }

        @Override
        public boolean c() {
            return false;
        }

        @Override
        public boolean d() {
            return false;
        }

        public boolean performClick() {
            if (super.performClick()) {
                return true;
            }
            this.playSoundEffect(0);
            d.this.d();
            return true;
        }

        protected boolean setFrame(int n2, int n3, int n4, int n5) {
            boolean bl2 = super.setFrame(n2, n3, n4, n5);
            Drawable drawable2 = this.getDrawable();
            Drawable drawable3 = this.getBackground();
            if (drawable2 != null && drawable3 != null) {
                int n6 = this.getWidth();
                n3 = this.getHeight();
                n2 = Math.max(n6, n3) / 2;
                int n7 = this.getPaddingLeft();
                int n8 = this.getPaddingRight();
                n4 = this.getPaddingTop();
                n5 = this.getPaddingBottom();
                n6 = (n6 + (n7 - n8)) / 2;
                n3 = (n3 + (n4 - n5)) / 2;
                android.support.v4.a.a.a.a(drawable3, n6 - n2, n3 - n2, n6 + n2, n3 + n2);
            }
            return bl2;
        }

    }

    private class e
    extends n {
        public e(Context context, h h2, View view, boolean bl2) {
            super(context, h2, view, bl2, a.a.actionOverflowMenuStyle);
            this.a(8388613);
            this.a(d.this.k);
        }

        @Override
        protected void e() {
            if (d.this.c != null) {
                d.this.c.close();
            }
            d.this.h = null;
            super.e();
        }
    }

    private class f
    implements o.a {
        f() {
        }

        @Override
        public void a(h h2, boolean bl2) {
            o.a a2;
            if (h2 instanceof u) {
                h2.p().a(false);
            }
            if ((a2 = d.this.a()) != null) {
                a2.a(h2, bl2);
            }
        }

        @Override
        public boolean a(h h2) {
            boolean bl2 = false;
            if (h2 == null) {
                return false;
            }
            d.this.l = ((u)h2).getItem().getItemId();
            o.a a2 = d.this.a();
            if (a2 != null) {
                bl2 = a2.a(h2);
            }
            return bl2;
        }
    }

}

