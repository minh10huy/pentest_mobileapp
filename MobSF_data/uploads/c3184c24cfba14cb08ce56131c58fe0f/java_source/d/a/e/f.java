/*
 * Decompiled with CFR 0_132.
 */
package d.a.e;

import d.a.c.h;
import d.a.c.k;
import d.a.e.b;
import d.a.e.c;
import d.a.e.g;
import d.a.e.i;
import d.aa;
import d.ab;
import d.ac;
import d.ad;
import d.e;
import d.p;
import d.s;
import d.t;
import d.u;
import d.x;
import d.y;
import e.l;
import e.r;
import java.io.IOException;
import java.net.ProtocolException;
import java.util.ArrayList;
import java.util.List;
import java.util.Locale;
import java.util.concurrent.TimeUnit;

public final class f
implements d.a.c.c {
    private static final e.f b = e.f.a("connection");
    private static final e.f c = e.f.a("host");
    private static final e.f d = e.f.a("keep-alive");
    private static final e.f e = e.f.a("proxy-connection");
    private static final e.f f = e.f.a("transfer-encoding");
    private static final e.f g = e.f.a("te");
    private static final e.f h = e.f.a("encoding");
    private static final e.f i = e.f.a("upgrade");
    private static final List<e.f> j = d.a.c.a(b, c, d, e, g, f, h, i, c.c, c.d, c.e, c.f);
    private static final List<e.f> k = d.a.c.a(b, c, d, e, g, f, h, i);
    final d.a.b.g a;
    private final x l;
    private final u.a m;
    private final g n;
    private i o;

    public f(x x2, u.a a2, d.a.b.g g2, g g3) {
        this.l = x2;
        this.m = a2;
        this.a = g2;
        this.n = g3;
    }

    public static ac.a a(List<c> list) {
        s.a a2 = new s.a();
        int n2 = list.size();
        c c2 = null;
        for (int i2 = 0; i2 < n2; ++i2) {
            s.a a3;
            Object object = list.get(i2);
            if (object == null) {
                object = c2;
                a3 = a2;
                if (c2 != null) {
                    object = c2;
                    a3 = a2;
                    if (c2.b == 100) {
                        a3 = new s.a();
                        object = null;
                    }
                }
            } else {
                e.f f2 = object.g;
                String string2 = object.h.a();
                if (f2.equals(c.b)) {
                    object = new StringBuilder();
                    object.append("HTTP/1.1 ");
                    object.append(string2);
                    object = k.a(object.toString());
                    a3 = a2;
                } else {
                    object = c2;
                    a3 = a2;
                    if (!k.contains(f2)) {
                        d.a.a.a.a(a2, f2.a(), string2);
                        a3 = a2;
                        object = c2;
                    }
                }
            }
            c2 = object;
            a2 = a3;
        }
        if (c2 != null) {
            return new ac.a().a(y.d).a(c2.b).a(c2.c).a(a2.a());
        }
        throw new ProtocolException("Expected ':status' header not present");
    }

    public static List<c> b(aa object) {
        s s2 = object.c();
        ArrayList<c> arrayList = new ArrayList<c>(s2.a() + 4);
        arrayList.add(new c(c.c, object.b()));
        arrayList.add(new c(c.d, d.a.c.i.a(object.a())));
        String string2 = object.a("Host");
        if (string2 != null) {
            arrayList.add(new c(c.f, string2));
        }
        arrayList.add(new c(c.e, object.a().b()));
        int n2 = s2.a();
        for (int i2 = 0; i2 < n2; ++i2) {
            object = e.f.a(s2.a(i2).toLowerCase(Locale.US));
            if (j.contains(object)) continue;
            arrayList.add(new c((e.f)object, s2.b(i2)));
        }
        return arrayList;
    }

    @Override
    public ac.a a(boolean bl2) {
        ac.a a2 = f.a(this.o.d());
        if (bl2 && d.a.a.a.a(a2) == 100) {
            return null;
        }
        return a2;
    }

    @Override
    public ad a(ac ac2) {
        this.a.c.f(this.a.b);
        return new h(ac2.a("Content-Type"), d.a.c.e.a(ac2), l.a(new a(this.o.g())));
    }

    @Override
    public r a(aa aa2, long l2) {
        return this.o.h();
    }

    @Override
    public void a() {
        this.n.b();
    }

    @Override
    public void a(aa object) {
        if (this.o != null) {
            return;
        }
        boolean bl2 = object.d() != null;
        object = f.b((aa)object);
        this.o = this.n.a((List<c>)object, bl2);
        this.o.e().a(this.m.c(), TimeUnit.MILLISECONDS);
        this.o.f().a(this.m.d(), TimeUnit.MILLISECONDS);
    }

    @Override
    public void b() {
        this.o.h().close();
    }

    @Override
    public void c() {
        if (this.o != null) {
            this.o.b(b.f);
        }
    }

    class a
    extends e.h {
        boolean a;
        long b;

        a(e.s s2) {
            super(s2);
            this.a = false;
            this.b = 0L;
        }

        private void a(IOException iOException) {
            if (this.a) {
                return;
            }
            this.a = true;
            f.this.a.a(false, f.this, this.b, iOException);
        }

        @Override
        public long a(e.c c2, long l2) {
            block3 : {
                try {
                    l2 = this.b().a(c2, l2);
                    if (l2 <= 0L) break block3;
                }
                catch (IOException iOException) {
                    this.a(iOException);
                    throw iOException;
                }
                this.b += l2;
            }
            return l2;
        }

        @Override
        public void close() {
            super.close();
            this.a(null);
        }
    }

}

