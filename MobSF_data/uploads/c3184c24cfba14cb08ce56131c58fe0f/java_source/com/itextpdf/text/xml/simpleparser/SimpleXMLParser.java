/*
 * Decompiled with CFR 0_132.
 */
package com.itextpdf.text.xml.simpleparser;

import com.itextpdf.text.error_messages.MessageLocalization;
import com.itextpdf.text.xml.XMLUtil;
import com.itextpdf.text.xml.simpleparser.EntitiesToUnicode;
import com.itextpdf.text.xml.simpleparser.IanaEncodings;
import com.itextpdf.text.xml.simpleparser.NewLineHandler;
import com.itextpdf.text.xml.simpleparser.SimpleXMLDocHandler;
import com.itextpdf.text.xml.simpleparser.SimpleXMLDocHandlerComment;
import java.io.BufferedReader;
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.Reader;
import java.util.HashMap;
import java.util.Map;
import java.util.Stack;

public final class SimpleXMLParser {
    private static final int ATTRIBUTE_EQUAL = 13;
    private static final int ATTRIBUTE_KEY = 12;
    private static final int ATTRIBUTE_VALUE = 14;
    private static final int CDATA = 7;
    private static final int COMMENT = 8;
    private static final int ENTITY = 10;
    private static final int EXAMIN_TAG = 3;
    private static final int IN_CLOSETAG = 5;
    private static final int PI = 9;
    private static final int QUOTE = 11;
    private static final int SINGLE_TAG = 6;
    private static final int TAG_ENCOUNTERED = 2;
    private static final int TAG_EXAMINED = 4;
    private static final int TEXT = 1;
    private static final int UNKNOWN = 0;
    private String attributekey;
    private HashMap<String, String> attributes;
    private String attributevalue;
    private int character;
    private int columns;
    private final SimpleXMLDocHandlerComment comment;
    private final SimpleXMLDocHandler doc;
    private final StringBuffer entity;
    private boolean eol;
    private final boolean html;
    private int lines;
    private int nested;
    private NewLineHandler newLineHandler;
    private boolean nowhite;
    private int previousCharacter;
    private int quoteCharacter;
    private final Stack<Integer> stack;
    private int state;
    private String tag;
    private final StringBuffer text;

    private SimpleXMLParser(SimpleXMLDocHandler simpleXMLDocHandler, SimpleXMLDocHandlerComment simpleXMLDocHandlerComment, boolean bl2) {
        RuntimeException runtimeException;
        super("d2j fail translate: java.lang.RuntimeException: can not merge I and Z\n\tat com.googlecode.dex2jar.ir.TypeClass.merge(TypeClass.java:100)\n\tat com.googlecode.dex2jar.ir.ts.TypeTransformer$TypeRef.updateTypeClass(TypeTransformer.java:174)\n\tat com.googlecode.dex2jar.ir.ts.TypeTransformer$TypeAnalyze.copyTypes(TypeTransformer.java:311)\n\tat com.googlecode.dex2jar.ir.ts.TypeTransformer$TypeAnalyze.fixTypes(TypeTransformer.java:226)\n\tat com.googlecode.dex2jar.ir.ts.TypeTransformer$TypeAnalyze.analyze(TypeTransformer.java:207)\n\tat com.googlecode.dex2jar.ir.ts.TypeTransformer.transform(TypeTransformer.java:44)\n\tat com.googlecode.d2j.dex.Dex2jar$2.optimize(Dex2jar.java:162)\n\tat com.googlecode.d2j.dex.Dex2Asm.convertCode(Dex2Asm.java:414)\n\tat com.googlecode.d2j.dex.ExDex2Asm.convertCode(ExDex2Asm.java:42)\n\tat com.googlecode.d2j.dex.Dex2jar$2.convertCode(Dex2jar.java:128)\n\tat com.googlecode.d2j.dex.Dex2Asm.convertMethod(Dex2Asm.java:509)\n\tat com.googlecode.d2j.dex.Dex2Asm.convertClass(Dex2Asm.java:406)\n\tat com.googlecode.d2j.dex.Dex2Asm.convertDex(Dex2Asm.java:422)\n\tat com.googlecode.d2j.dex.Dex2jar.doTranslate(Dex2jar.java:172)\n\tat com.googlecode.d2j.dex.Dex2jar.to(Dex2jar.java:272)\n\tat com.googlecode.dex2jar.tools.Dex2jarCmd.doCommandLine(Dex2jarCmd.java:108)\n\tat com.googlecode.dex2jar.tools.BaseCmd.doMain(BaseCmd.java:288)\n\tat com.googlecode.dex2jar.tools.Dex2jarCmd.main(Dex2jarCmd.java:32)\n");
        throw runtimeException;
    }

    private void doTag() {
        if (this.tag == null) {
            this.tag = this.text.toString();
        }
        if (this.html) {
            this.tag = this.tag.toLowerCase();
        }
        this.text.setLength(0);
    }

    @Deprecated
    public static String escapeXML(String string2, boolean bl2) {
        return XMLUtil.escapeXML(string2, bl2);
    }

    private void flush() {
        switch (this.state) {
            default: {
                break;
            }
            case 12: {
                this.attributekey = this.text.toString();
                if (!this.html) break;
                this.attributekey = this.attributekey.toLowerCase();
                break;
            }
            case 11: 
            case 14: {
                this.attributevalue = this.text.toString();
                this.attributes.put(this.attributekey, this.attributevalue);
                break;
            }
            case 8: {
                if (this.comment == null) break;
                this.comment.comment(this.text.toString());
                break;
            }
            case 1: 
            case 7: {
                if (this.text.length() <= 0) break;
                this.doc.text(this.text.toString());
            }
        }
        this.text.setLength(0);
    }

    private static String getDeclaredEncoding(String string2) {
        if (string2 == null) {
            return null;
        }
        int n2 = string2.indexOf("encoding");
        if (n2 < 0) {
            return null;
        }
        int n3 = string2.indexOf(34, n2);
        if (n3 == (n2 = string2.indexOf(39, n2))) {
            return null;
        }
        if (n3 < 0 && n2 > 0 || n2 > 0 && n2 < n3) {
            n3 = n2 + 1;
            n2 = string2.indexOf(39, n3);
            if (n2 < 0) {
                return null;
            }
            return string2.substring(n3, n2);
        }
        if (n2 < 0 && n3 > 0 || n3 > 0 && n3 < n2) {
            if ((n2 = string2.indexOf(34, ++n3)) < 0) {
                return null;
            }
            return string2.substring(n3, n2);
        }
        return null;
    }

    /*
     * Unable to fully structure code
     * Enabled aggressive block sorting
     * Lifted jumps to return sites
     */
    private void go(Reader var1_1) {
        var1_1 = var1_1 instanceof BufferedReader != false ? (BufferedReader)var1_1 : new BufferedReader(var1_1);
        this.doc.startDocument();
        block17 : do {
            block56 : {
                block55 : {
                    block54 : {
                        if (this.previousCharacter == -1) {
                            this.character = var1_1.read();
                        } else {
                            this.character = this.previousCharacter;
                            this.previousCharacter = -1;
                        }
                        if (this.character == -1) {
                            if (!this.html) {
                                this.throwException(MessageLocalization.getComposedMessage("missing.end.tag", new Object[0]));
                                return;
                            }
                            if (this.html && this.state == 1) {
                                this.flush();
                            }
                            this.doc.endDocument();
                            return;
                        }
                        if (this.character == 10 && this.eol) {
                            this.eol = false;
                            continue;
                        }
                        if (!this.eol) break block54;
                        this.eol = false;
                        break block55;
                    }
                    if (this.character == 10) ** GOTO lbl28
                    if (this.character == 13) {
                        this.eol = true;
                        this.character = 10;
lbl28: // 2 sources:
                        ++this.lines;
                        this.columns = 0;
                    } else {
                        ++this.columns;
                    }
                }
                switch (this.state) {
                    default: {
                        continue block17;
                    }
                    case 14: {
                        if (this.character == 34 || this.character == 39) ** GOTO lbl44
                        if (Character.isWhitespace((char)this.character)) continue block17;
                        if (this.html && this.character == 62) ** GOTO lbl73
                        if (!this.html) ** GOTO lbl57
                        this.text.append((char)this.character);
                        this.quoteCharacter = 32;
                        ** GOTO lbl45
lbl44: // 1 sources:
                        this.quoteCharacter = this.character;
lbl45: // 2 sources:
                        var3_3 = 11;
                        ** GOTO lbl192
                    }
                    case 13: {
                        if (this.character == 61) ** GOTO lbl66
                        if (Character.isWhitespace((char)this.character)) continue block17;
                        if (this.html && this.character == 62) ** GOTO lbl69
                        if (!this.html || this.character != 47) ** GOTO lbl54
                        this.flush();
                        ** GOTO lbl161
lbl54: // 1 sources:
                        if (!this.html) ** GOTO lbl57
                        this.flush();
                        ** GOTO lbl150
lbl57: // 2 sources:
                        this.throwException(MessageLocalization.getComposedMessage("error.in.attribute.processing", new Object[0]));
                        continue block17;
                    }
                    case 12: {
                        if (Character.isWhitespace((char)this.character)) {
                            this.flush();
                            this.state = 13;
                            continue block17;
                        }
                        if (this.character != 61) ** GOTO lbl68
                        this.flush();
lbl66: // 2 sources:
                        var3_3 = 14;
                        ** GOTO lbl192
lbl68: // 1 sources:
                        if (!this.html || this.character != 62) ** GOTO lbl178
lbl69: // 2 sources:
                        this.text.setLength(0);
                        ** GOTO lbl156
                    }
                    case 11: {
                        if (!this.html || this.quoteCharacter != 32 || this.character != 62) ** GOTO lbl75
lbl73: // 2 sources:
                        this.flush();
                        ** GOTO lbl156
lbl75: // 1 sources:
                        if (this.html && this.quoteCharacter == 32 && Character.isWhitespace((char)this.character)) ** GOTO lbl78
                        if (this.html && this.quoteCharacter == 32) ** GOTO lbl178
                        if (this.character != this.quoteCharacter) ** GOTO lbl80
lbl78: // 2 sources:
                        this.flush();
                        ** GOTO lbl176
lbl80: // 1 sources:
                        if (" \r\n\t".indexOf(this.character) >= 0) {
                            this.text.append(' ');
                            continue block17;
                        }
                        if (this.character != 38) ** GOTO lbl178
                        this.saveState(this.state);
                        this.state = 10;
                        ** GOTO lbl107
                    }
                    case 10: {
                        if (this.character == 59) {
                            this.state = this.restoreState();
                            var4_4 = this.entity.toString();
                            this.entity.setLength(0);
                            var2_2 = EntitiesToUnicode.decodeEntity((String)var4_4);
                            if (var2_2 == '\u0000') {
                                var5_5 = this.text;
                                var5_5.append('&');
                                var5_5.append((String)var4_4);
                                var5_5.append(';');
                                continue block17;
                            }
                            this.text.append(var2_2);
                            continue block17;
                        }
                        if ((this.character == 35 || this.character >= 48 && this.character <= 57 || this.character >= 97 && this.character <= 122 || this.character >= 65 && this.character <= 90) && this.entity.length() < 7) ** GOTO lbl109
                        this.state = this.restoreState();
                        this.previousCharacter = this.character;
                        var4_4 = this.text;
                        var4_4.append('&');
                        var4_4.append(this.entity.toString());
lbl107: // 2 sources:
                        this.entity.setLength(0);
                        continue block17;
lbl109: // 1 sources:
                        var4_4 = this.entity;
                        ** GOTO lbl179
                    }
                    case 9: {
                        if (this.character != 62) continue block17;
                        this.state = this.restoreState();
                        if (this.state != 1) continue block17;
                        this.state = 0;
                        continue block17;
                    }
                    case 8: {
                        if (this.character != 62 || !this.text.toString().endsWith("--")) ** GOTO lbl178
                        ** GOTO lbl122
                    }
                    case 7: {
                        if (this.character != 62 || !this.text.toString().endsWith("]]")) ** GOTO lbl178
lbl122: // 2 sources:
                        this.text.setLength(this.text.length() - 2);
                        this.flush();
                        ** GOTO lbl158
                    }
                    case 6: {
                        if (this.character != 62) {
                            this.throwException(MessageLocalization.getComposedMessage("expected.gt.for.tag.lt.1.gt", new Object[]{this.tag}));
                        }
                        this.doTag();
                        this.processTag(true);
                        this.processTag(false);
                        this.initTag();
                        if (!this.html && this.nested == 0) {
                            this.doc.endDocument();
                            return;
                        }
                        ** GOTO lbl158
                    }
                    case 5: {
                        if (this.character != 62) ** GOTO lbl143
                        this.doTag();
                        this.processTag(false);
                        if (!this.html && this.nested == 0) {
                            return;
                        }
                        ** GOTO lbl158
lbl143: // 1 sources:
                        if (Character.isWhitespace((char)this.character)) continue block17;
                        ** GOTO lbl178
                    }
                    case 4: {
                        if (this.character == 62) ** GOTO lbl156
                        if (this.character != 47) {
                            if (Character.isWhitespace((char)this.character)) continue block17;
                        }
                        ** GOTO lbl161
lbl150: // 2 sources:
                        this.text.append((char)this.character);
                        var3_3 = 12;
                        ** GOTO lbl192
                    }
                    case 3: {
                        if (this.character != 62) ** GOTO lbl160
                        this.doTag();
lbl156: // 4 sources:
                        this.processTag(true);
                        this.initTag();
lbl158: // 4 sources:
                        var3_3 = this.restoreState();
                        ** GOTO lbl192
lbl160: // 1 sources:
                        if (this.character != 47) ** GOTO lbl163
lbl161: // 3 sources:
                        this.state = 6;
                        continue block17;
lbl163: // 1 sources:
                        if (this.character != 45 || !this.text.toString().equals("!-")) ** GOTO lbl167
                        this.flush();
                        var3_3 = 8;
                        ** GOTO lbl192
lbl167: // 1 sources:
                        if (this.character != 91 || !this.text.toString().equals("![CDATA")) ** GOTO lbl171
                        this.flush();
                        var3_3 = 7;
                        ** GOTO lbl192
lbl171: // 1 sources:
                        if (this.character != 69 || !this.text.toString().equals("!DOCTYP")) ** GOTO lbl174
                        this.flush();
                        ** GOTO lbl188
lbl174: // 1 sources:
                        if (!Character.isWhitespace((char)this.character)) ** GOTO lbl178
                        this.doTag();
lbl176: // 2 sources:
                        this.state = 4;
                        continue block17;
lbl178: // 7 sources:
                        var4_4 = this.text;
lbl179: // 2 sources:
                        var4_4.append((char)this.character);
                        continue block17;
                    }
                    case 2: {
                        this.initTag();
                        if (this.character == 47) {
                            var3_3 = 5;
                        } else if (this.character == 63) {
                            this.restoreState();
lbl188: // 2 sources:
                            var3_3 = 9;
                        } else {
                            this.text.append((char)this.character);
                            var3_3 = 3;
                        }
lbl192: // 9 sources:
                        this.state = var3_3;
                        continue block17;
                    }
                    case 1: {
                        if (this.character != 60) ** GOTO lbl199
                        this.flush();
                        this.saveState(this.state);
                        break block56;
lbl199: // 1 sources:
                        if (this.character != 38) ** GOTO lbl204
                        this.saveState(this.state);
                        this.entity.setLength(0);
                        this.state = 10;
                        ** GOTO lbl217
lbl204: // 1 sources:
                        if (this.character != 32) ** GOTO lbl210
                        if (!this.html || !this.nowhite) ** GOTO lbl208
                        this.text.append(' ');
                        ** GOTO lbl214
lbl208: // 1 sources:
                        if (!this.nowhite) ** GOTO lbl214
                        ** GOTO lbl213
lbl210: // 1 sources:
                        if (!Character.isWhitespace((char)this.character)) ** GOTO lbl216
                        if (this.html) continue block17;
                        if (!this.nowhite) ** GOTO lbl214
lbl213: // 2 sources:
                        this.text.append((char)this.character);
lbl214: // 4 sources:
                        this.nowhite = false;
                        continue block17;
lbl216: // 1 sources:
                        this.text.append((char)this.character);
lbl217: // 2 sources:
                        this.nowhite = true;
                        continue block17;
                    }
                    case 0: 
                }
                if (this.character != 60) continue;
                this.saveState(1);
            }
            this.state = 2;
        } while (true);
    }

    private void initTag() {
        this.tag = null;
        this.attributes = new HashMap();
    }

    public static void parse(SimpleXMLDocHandler simpleXMLDocHandler, SimpleXMLDocHandlerComment simpleXMLDocHandlerComment, Reader reader, boolean bl2) {
        new SimpleXMLParser(simpleXMLDocHandler, simpleXMLDocHandlerComment, bl2).go(reader);
    }

    public static void parse(SimpleXMLDocHandler simpleXMLDocHandler, InputStream inputStream) {
        Object object = new byte[4];
        if (inputStream.read((byte[])object) == 4) {
            String string2 = XMLUtil.getEncodingName((byte[])object);
            object = null;
            if (string2.equals("UTF-8")) {
                int n2;
                object = new StringBuffer();
                while ((n2 = inputStream.read()) != -1 && n2 != 62) {
                    object.append((char)n2);
                }
                object = object.toString();
            } else if (string2.equals("CP037")) {
                int n3;
                object = new ByteArrayOutputStream();
                while ((n3 = inputStream.read()) != -1 && n3 != 110) {
                    object.write(n3);
                }
                object = new String(object.toByteArray(), "CP037");
            }
            Object object2 = string2;
            if (object != null) {
                object = SimpleXMLParser.getDeclaredEncoding((String)object);
                object2 = string2;
                if (object != null) {
                    object2 = object;
                }
            }
            SimpleXMLParser.parse(simpleXMLDocHandler, new InputStreamReader(inputStream, IanaEncodings.getJavaEncoding((String)object2)));
            return;
        }
        throw new IOException(MessageLocalization.getComposedMessage("insufficient.length", new Object[0]));
    }

    public static void parse(SimpleXMLDocHandler simpleXMLDocHandler, Reader reader) {
        SimpleXMLParser.parse(simpleXMLDocHandler, null, reader, false);
    }

    private void processTag(boolean bl2) {
        if (bl2) {
            ++this.nested;
            this.doc.startElement(this.tag, this.attributes);
            return;
        }
        if (this.newLineHandler.isNewLineTag(this.tag)) {
            this.nowhite = false;
        }
        --this.nested;
        this.doc.endElement(this.tag);
    }

    private int restoreState() {
        if (!this.stack.empty()) {
            return this.stack.pop();
        }
        return 0;
    }

    private void saveState(int n2) {
        this.stack.push(n2);
    }

    private void throwException(String string2) {
        throw new IOException(MessageLocalization.getComposedMessage("1.near.line.2.column.3", string2, String.valueOf(this.lines), String.valueOf(this.columns)));
    }
}

