/*
 * Decompiled with CFR 0_132.
 */
package com.itextpdf.text.pdf;

import com.itextpdf.text.pdf.PdfArray;
import com.itextpdf.text.pdf.PdfDictionary;
import com.itextpdf.text.pdf.PdfIndirectObject;
import com.itextpdf.text.pdf.PdfIndirectReference;
import com.itextpdf.text.pdf.PdfName;
import com.itextpdf.text.pdf.PdfNumber;
import com.itextpdf.text.pdf.PdfObject;
import com.itextpdf.text.pdf.PdfReader;
import com.itextpdf.text.pdf.PdfWriter;
import java.io.Serializable;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Set;

public class PdfNumberTree {
    private static final int leafSize = 64;

    private static void iterateItems(PdfDictionary pdfObject, HashMap<Integer, PdfObject> hashMap) {
        block3 : {
            int n2;
            block2 : {
                PdfArray pdfArray = (PdfArray)PdfReader.getPdfObjectRelease(pdfObject.get(PdfName.NUMS));
                int n3 = 0;
                n2 = 0;
                if (pdfArray == null) break block2;
                while (n2 < pdfArray.size()) {
                    n3 = n2 + 1;
                    hashMap.put(((PdfNumber)PdfReader.getPdfObjectRelease(pdfArray.getPdfObject(n2))).intValue(), pdfArray.getPdfObject(n3));
                    n2 = n3 + 1;
                }
                break block3;
            }
            if ((pdfObject = (PdfArray)PdfReader.getPdfObjectRelease(pdfObject.get(PdfName.KIDS))) == null) break block3;
            for (n2 = n3; n2 < pdfObject.size(); ++n2) {
                PdfNumberTree.iterateItems((PdfDictionary)PdfReader.getPdfObjectRelease(pdfObject.getPdfObject(n2)), hashMap);
            }
        }
    }

    public static HashMap<Integer, PdfObject> readTree(PdfDictionary pdfDictionary) {
        HashMap<Integer, PdfObject> hashMap = new HashMap<Integer, PdfObject>();
        if (pdfDictionary != null) {
            PdfNumberTree.iterateItems(pdfDictionary, hashMap);
        }
        return hashMap;
    }

    public static <O extends PdfObject> PdfDictionary writeTree(HashMap<Integer, O> serializable, PdfWriter object) {
        int n2;
        int n3;
        PdfObject pdfObject;
        int n4;
        if (serializable.isEmpty()) {
            return null;
        }
        Object[] arrobject = new Integer[serializable.size()];
        arrobject = serializable.keySet().toArray(arrobject);
        Arrays.sort(arrobject);
        if (arrobject.length <= 64) {
            object = new PdfDictionary();
            PdfArray pdfArray = new PdfArray();
            for (int i2 = 0; i2 < arrobject.length; ++i2) {
                pdfArray.add(new PdfNumber(arrobject[i2].intValue()));
                pdfArray.add((PdfObject)serializable.get(arrobject[i2]));
            }
            object.put(PdfName.NUMS, pdfArray);
            return object;
        }
        PdfIndirectReference[] arrpdfIndirectReference = new PdfIndirectReference[(arrobject.length + 64 - 1) / 64];
        for (n3 = 0; n3 < arrpdfIndirectReference.length; ++n3) {
            n4 = Math.min(n2 + 64, arrobject.length);
            pdfObject = new PdfDictionary();
            PdfArray pdfArray = new PdfArray();
            pdfArray.add(new PdfNumber(arrobject[n2].intValue()));
            pdfArray.add(new PdfNumber(arrobject[n4 - 1].intValue()));
            pdfObject.put(PdfName.LIMITS, pdfArray);
            pdfArray = new PdfArray();
            for (n2 = n3 * 64; n2 < n4; ++n2) {
                pdfArray.add(new PdfNumber(arrobject[n2].intValue()));
                pdfArray.add((PdfObject)serializable.get(arrobject[n2]));
            }
            pdfObject.put(PdfName.NUMS, pdfArray);
            arrpdfIndirectReference[n3] = object.addToBody(pdfObject).getIndirectReference();
        }
        n3 = arrpdfIndirectReference.length;
        n2 = 64;
        do {
            if (n3 <= 64) {
                serializable = new PdfArray();
                for (n2 = 0; n2 < n3; ++n2) {
                    serializable.add(arrpdfIndirectReference[n2]);
                }
                object = new PdfDictionary();
                object.put(PdfName.KIDS, (PdfObject)serializable);
                return object;
            }
            int n5 = n2 * 64;
            int n6 = (arrobject.length + n5 - 1) / n5;
            n2 = 0;
            while (n2 < n6) {
                int n7 = Math.min(n4 + 64, n3);
                serializable = new PdfDictionary();
                pdfObject = new PdfArray();
                pdfObject.add(new PdfNumber(arrobject[n2 * n5].intValue()));
                int n8 = n2 + 1;
                pdfObject.add(new PdfNumber(arrobject[Math.min(n8 * n5, arrobject.length) - 1].intValue()));
                serializable.put(PdfName.LIMITS, pdfObject);
                pdfObject = new PdfArray();
                for (n4 = n2 * 64; n4 < n7; ++n4) {
                    pdfObject.add(arrpdfIndirectReference[n4]);
                }
                serializable.put(PdfName.KIDS, pdfObject);
                arrpdfIndirectReference[n2] = object.addToBody((PdfObject)serializable).getIndirectReference();
                n2 = n8;
            }
            n3 = n6;
            n2 = n5;
        } while (true);
    }
}

