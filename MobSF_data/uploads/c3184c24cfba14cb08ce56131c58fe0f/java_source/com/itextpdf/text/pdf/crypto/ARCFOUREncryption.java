/*
 * Decompiled with CFR 0_132.
 */
package com.itextpdf.text.pdf.crypto;

public class ARCFOUREncryption {
    private byte[] state = new byte[256];
    private int x;
    private int y;

    public void encryptARCFOUR(byte[] arrby) {
        this.encryptARCFOUR(arrby, 0, arrby.length, arrby, 0);
    }

    public void encryptARCFOUR(byte[] arrby, int n2, int n3) {
        this.encryptARCFOUR(arrby, n2, n3, arrby, n2);
    }

    public void encryptARCFOUR(byte[] arrby, int n2, int n3, byte[] arrby2, int n4) {
        for (int i2 = n2; i2 < n3 + n2; ++i2) {
            this.x = this.x + 1 & 255;
            this.y = this.state[this.x] + this.y & 255;
            byte by2 = this.state[this.x];
            this.state[this.x] = this.state[this.y];
            this.state[this.y] = by2;
            arrby2[i2 - n2 + n4] = (byte)(arrby[i2] ^ this.state[this.state[this.x] + this.state[this.y] & 255]);
        }
    }

    public void encryptARCFOUR(byte[] arrby, byte[] arrby2) {
        this.encryptARCFOUR(arrby, 0, arrby.length, arrby2, 0);
    }

    public void prepareARCFOURKey(byte[] arrby) {
        this.prepareARCFOURKey(arrby, 0, arrby.length);
    }

    public void prepareARCFOURKey(byte[] arrby, int n2, int n3) {
        int n4;
        int n5 = 0;
        for (n4 = 0; n4 < 256; ++n4) {
            this.state[n4] = (byte)n4;
        }
        this.x = 0;
        this.y = 0;
        int n6 = 0;
        int n7 = 0;
        for (n4 = n5; n4 < 256; ++n4) {
            n7 = arrby[n6 + n2] + this.state[n4] + n7 & 255;
            byte by2 = this.state[n4];
            this.state[n4] = this.state[n7];
            this.state[n7] = by2;
            n6 = (n6 + 1) % n3;
        }
    }
}

