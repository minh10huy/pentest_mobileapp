/*
 * Decompiled with CFR 0_132.
 */
package com.itextpdf.text.pdf.security;

import com.itextpdf.text.pdf.security.VerificationOK;
import java.io.Serializable;
import java.security.PublicKey;
import java.security.cert.X509Certificate;
import java.util.ArrayList;
import java.util.Collection;
import java.util.Date;
import java.util.List;

public class CertificateVerifier {
    protected boolean onlineCheckingAllowed = true;
    protected CertificateVerifier verifier;

    public CertificateVerifier(CertificateVerifier certificateVerifier) {
        this.verifier = certificateVerifier;
    }

    public void setOnlineCheckingAllowed(boolean bl2) {
        this.onlineCheckingAllowed = bl2;
    }

    /*
     * Enabled aggressive block sorting
     */
    public List<VerificationOK> verify(X509Certificate x509Certificate, X509Certificate x509Certificate2, Date date) {
        if (date != null) {
            x509Certificate.checkValidity(date);
        }
        Serializable serializable = x509Certificate2 != null ? x509Certificate2.getPublicKey() : x509Certificate.getPublicKey();
        x509Certificate.verify((PublicKey)serializable);
        serializable = new ArrayList();
        if (this.verifier != null) {
            serializable.addAll(this.verifier.verify(x509Certificate, x509Certificate2, date));
        }
        return serializable;
    }
}

