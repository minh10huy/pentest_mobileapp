/*
 * Decompiled with CFR 0_132.
 * 
 * Could not load the following classes:
 *  android.content.Context
 *  android.content.Intent
 *  android.content.pm.PackageInfo
 *  android.content.pm.PackageManager
 *  android.content.pm.PackageManager$NameNotFoundException
 *  android.util.Base64
 *  android.util.Log
 */
package com.google.firebase.iid;

import android.content.Context;
import android.content.Intent;
import android.content.pm.PackageInfo;
import android.content.pm.PackageManager;
import android.util.Base64;
import android.util.Log;
import com.google.android.gms.common.util.p;
import com.google.firebase.b;
import com.google.firebase.e;
import java.security.KeyPair;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;
import java.security.PublicKey;
import java.util.List;

public final class aa {
    private final Context a;
    private String b;
    private String c;
    private int d;
    private int e = 0;

    public aa(Context context) {
        this.a = context;
    }

    private final PackageInfo a(String string2) {
        try {
            string2 = this.a.getPackageManager().getPackageInfo(string2, 0);
            return string2;
        }
        catch (PackageManager.NameNotFoundException nameNotFoundException) {
            String string3 = String.valueOf((Object)nameNotFoundException);
            StringBuilder stringBuilder = new StringBuilder(String.valueOf(string3).length() + 23);
            stringBuilder.append("Failed to find package ");
            stringBuilder.append(string3);
            Log.w((String)"FirebaseInstanceId", (String)stringBuilder.toString());
            return null;
        }
    }

    public static String a(b object) {
        String string2 = object.c().c();
        if (string2 != null) {
            return string2;
        }
        if (!(object = object.c().b()).startsWith("1:")) {
            return object;
        }
        if (((String[])(object = object.split(":"))).length < 2) {
            return null;
        }
        if ((object = object[1]).isEmpty()) {
            return null;
        }
        return object;
    }

    /*
     * Enabled aggressive block sorting
     * Enabled unnecessary exception pruning
     * Enabled aggressive exception aggregation
     */
    public static String a(KeyPair object) {
        byte[] arrby;
        byte[] arrby2 = object.getPublic().getEncoded();
        try {
            arrby = MessageDigest.getInstance("SHA1").digest(arrby2);
        }
        catch (NoSuchAlgorithmException noSuchAlgorithmException) {}
        arrby[0] = (byte)((arrby[0] & 15) + 112);
        return Base64.encodeToString((byte[])arrby, (int)0, (int)8, (int)11);
        Log.w((String)"FirebaseInstanceId", (String)"Unexpected error, device missing required algorithms");
        return null;
    }

    /*
     * Enabled aggressive block sorting
     * Enabled unnecessary exception pruning
     * Enabled aggressive exception aggregation
     */
    private final void e() {
        synchronized (this) {
            PackageInfo packageInfo = this.a(this.a.getPackageName());
            if (packageInfo != null) {
                this.b = Integer.toString(packageInfo.versionCode);
                this.c = packageInfo.versionName;
            }
            return;
        }
    }

    public final int a() {
        synchronized (this) {
            block12 : {
                Object object;
                Object object2;
                block11 : {
                    block10 : {
                        block9 : {
                            if (this.e == 0) break block9;
                            int n2 = this.e;
                            return n2;
                        }
                        object2 = this.a.getPackageManager();
                        if (object2.checkPermission("com.google.android.c2dm.permission.SEND", "com.google.android.gms") != -1) break block10;
                        Log.e((String)"FirebaseInstanceId", (String)"Google Play services missing or without correct permission.");
                        return 0;
                    }
                    if (p.i()) break block11;
                    object = new Intent("com.google.android.c2dm.intent.REGISTER");
                    object.setPackage("com.google.android.gms");
                    object = object2.queryIntentServices((Intent)object, 0);
                    if (object == null) break block11;
                    if (object.size() <= 0) break block11;
                    int n3 = this.e = 1;
                    return n3;
                }
                object = new Intent("com.google.iid.TOKEN_REQUEST");
                object.setPackage("com.google.android.gms");
                object2 = object2.queryBroadcastReceivers((Intent)object, 0);
                if (object2 == null) break block12;
                if (object2.size() <= 0) break block12;
                int n4 = this.e = 2;
                return n4;
            }
            Log.w((String)"FirebaseInstanceId", (String)"Failed to resolve IID implementation package, falling back");
            this.e = p.i() ? 2 : 1;
            int n5 = this.e;
            return n5;
        }
    }

    public final String b() {
        synchronized (this) {
            if (this.b == null) {
                this.e();
            }
            String string2 = this.b;
            return string2;
        }
    }

    public final String c() {
        synchronized (this) {
            if (this.c == null) {
                this.e();
            }
            String string2 = this.c;
            return string2;
        }
    }

    /*
     * Enabled force condition propagation
     * Lifted jumps to return sites
     */
    public final int d() {
        synchronized (this) {
            if (this.d != 0) return this.d;
            PackageInfo packageInfo = this.a("com.google.android.gms");
            if (packageInfo == null) return this.d;
            this.d = packageInfo.versionCode;
            return this.d;
        }
    }
}

