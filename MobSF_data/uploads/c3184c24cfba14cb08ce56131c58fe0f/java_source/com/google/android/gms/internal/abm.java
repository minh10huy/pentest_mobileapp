/*
 * Decompiled with CFR 0_132.
 * 
 * Could not load the following classes:
 *  android.content.Context
 *  android.content.SharedPreferences
 *  android.content.SharedPreferences$Editor
 *  android.os.Build
 *  android.os.Build$VERSION
 *  android.text.TextUtils
 *  android.util.Pair
 */
package com.google.android.gms.internal;

import android.content.Context;
import android.content.SharedPreferences;
import android.os.Build;
import android.text.TextUtils;
import android.util.Pair;
import com.google.android.gms.ads.c.a;
import com.google.android.gms.common.util.f;
import com.google.android.gms.internal.aab;
import com.google.android.gms.internal.aai;
import com.google.android.gms.internal.aaq;
import com.google.android.gms.internal.aas;
import com.google.android.gms.internal.abb;
import com.google.android.gms.internal.abd;
import com.google.android.gms.internal.abn;
import com.google.android.gms.internal.abo;
import com.google.android.gms.internal.abp;
import com.google.android.gms.internal.abq;
import com.google.android.gms.internal.abr;
import com.google.android.gms.internal.acc;
import com.google.android.gms.internal.adc;
import com.google.android.gms.internal.afk;
import java.math.BigInteger;
import java.security.MessageDigest;
import java.util.Locale;

final class abm
extends adc {
    static final Pair<String, Long> a = new Pair((Object)"", (Object)0L);
    public abq b;
    public final abp c = new abp(this, "last_upload", 0L);
    public final abp d = new abp(this, "last_upload_attempt", 0L);
    public final abp e = new abp(this, "backoff", 0L);
    public final abp f = new abp(this, "last_delete_stale", 0L);
    public final abp g = new abp(this, "midnight_offset", 0L);
    public final abp h = new abp(this, "first_open_time", 0L);
    public final abr i = new abr(this, "app_instance_id", null);
    public final abp j = new abp(this, "time_before_start", 10000L);
    public final abp k = new abp(this, "session_timeout", 1800000L);
    public final abo l = new abo(this, "start_new_session", true);
    public final abp m = new abp(this, "last_pause_time", 0L);
    public final abp n = new abp(this, "time_active", 0L);
    public boolean o;
    private SharedPreferences q;
    private String r;
    private boolean s;
    private long t;
    private String u;
    private long v;
    private final Object w = new Object();

    abm(acc acc2) {
        super(acc2);
    }

    private final SharedPreferences D() {
        this.c();
        this.Q();
        return this.q;
    }

    static /* synthetic */ SharedPreferences a(abm abm2) {
        return abm2.D();
    }

    final Boolean A() {
        this.c();
        if (!this.D().contains("use_service")) {
            return null;
        }
        return this.D().getBoolean("use_service", false);
    }

    final void B() {
        this.c();
        this.t().E().a("Clearing collection preferences.");
        boolean bl2 = this.D().contains("measurement_enabled");
        boolean bl3 = true;
        if (bl2) {
            bl3 = this.c(true);
        }
        SharedPreferences.Editor editor = this.D().edit();
        editor.clear();
        editor.apply();
        if (bl2) {
            this.b(bl3);
        }
    }

    protected final String C() {
        this.c();
        String string2 = this.D().getString("previous_os_version", null);
        this.h().Q();
        String string3 = Build.VERSION.RELEASE;
        if (!TextUtils.isEmpty((CharSequence)string3) && !string3.equals(string2)) {
            SharedPreferences.Editor editor = this.D().edit();
            editor.putString("previous_os_version", string3);
            editor.apply();
        }
        return string2;
    }

    /*
     * Enabled aggressive block sorting
     * Enabled unnecessary exception pruning
     * Enabled aggressive exception aggregation
     */
    final Pair<String, Boolean> a(String object) {
        this.c();
        long l2 = this.k().b();
        if (this.r != null && l2 < this.t) {
            return new Pair((Object)this.r, (Object)this.s);
        }
        this.t = l2 + this.v().a((String)object, aaq.h);
        a.a(true);
        try {
            object = a.a(this.l());
            if (object != null) {
                this.r = object.a();
                this.s = object.b();
            }
            if (this.r == null) {
                this.r = "";
            }
        }
        catch (Throwable throwable) {
            this.t().D().a("Unable to get advertising id", throwable);
            this.r = "";
        }
        a.a(false);
        return new Pair((Object)this.r, (Object)this.s);
    }

    final void a(boolean bl2) {
        this.c();
        this.t().E().a("Setting useService", bl2);
        SharedPreferences.Editor editor = this.D().edit();
        editor.putBoolean("use_service", bl2);
        editor.apply();
    }

    final String b(String string2) {
        this.c();
        string2 = (String)this.a((String)string2).first;
        MessageDigest messageDigest = afk.f("MD5");
        if (messageDigest == null) {
            return null;
        }
        return String.format(Locale.US, "%032X", new BigInteger(1, messageDigest.digest(string2.getBytes())));
    }

    final void b(boolean bl2) {
        this.c();
        this.t().E().a("Setting measurementEnabled", bl2);
        SharedPreferences.Editor editor = this.D().edit();
        editor.putBoolean("measurement_enabled", bl2);
        editor.apply();
    }

    final void c(String string2) {
        this.c();
        SharedPreferences.Editor editor = this.D().edit();
        editor.putString("gmp_app_id", string2);
        editor.apply();
    }

    final boolean c(boolean bl2) {
        this.c();
        return this.D().getBoolean("measurement_enabled", bl2);
    }

    /*
     * Enabled aggressive block sorting
     * Enabled unnecessary exception pruning
     * Enabled aggressive exception aggregation
     */
    final void d(String string2) {
        Object object = this.w;
        synchronized (object) {
            this.u = string2;
            this.v = this.k().b();
            return;
        }
    }

    @Override
    protected final void s_() {
        this.q = this.l().getSharedPreferences("com.google.android.gms.measurement.prefs", 0);
        this.o = this.q.getBoolean("has_been_opened", false);
        if (!this.o) {
            SharedPreferences.Editor editor = this.q.edit();
            editor.putBoolean("has_been_opened", true);
            editor.apply();
        }
        this.b = new abq(this, "health_monitor", Math.max(0L, aaq.i.b()), null);
    }

    @Override
    protected final boolean w() {
        return true;
    }

    final String y() {
        this.c();
        return this.D().getString("gmp_app_id", null);
    }

    /*
     * Enabled aggressive block sorting
     * Enabled unnecessary exception pruning
     * Enabled aggressive exception aggregation
     */
    final String z() {
        Object object = this.w;
        synchronized (object) {
            if (Math.abs(this.k().b() - this.v) >= 1000L) return null;
            return this.u;
        }
    }
}

