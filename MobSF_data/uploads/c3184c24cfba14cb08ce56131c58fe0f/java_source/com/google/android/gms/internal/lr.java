/*
 * Decompiled with CFR 0_132.
 */
package com.google.android.gms.internal;

import com.google.android.gms.internal.ak;
import com.google.android.gms.internal.he;
import com.google.android.gms.internal.kd;
import java.io.IOException;
import java.net.HttpURLConnection;
import java.net.URL;
import java.net.URLConnection;

@ak
public final class lr {
    public static HttpURLConnection a(String object, int n2) {
        object = new URL((String)object);
        int n3 = 0;
        while (++n3 <= 20) {
            Object object2 = object.openConnection();
            object2.setConnectTimeout(n2);
            object2.setReadTimeout(n2);
            if (object2 instanceof HttpURLConnection) {
                HttpURLConnection httpURLConnection = (HttpURLConnection)object2;
                object2 = new kd();
                object2.a(httpURLConnection, null);
                httpURLConnection.setInstanceFollowRedirects(false);
                int n4 = httpURLConnection.getResponseCode();
                object2.a(httpURLConnection, n4);
                if (n4 / 100 == 3) {
                    String string2 = httpURLConnection.getHeaderField("Location");
                    if (string2 != null) {
                        object2 = new URL((URL)object, string2);
                        object = object2.getProtocol();
                        if (object != null) {
                            if (!object.equals("http") && !object.equals("https")) {
                                object = (object = String.valueOf(object)).length() != 0 ? "Unsupported scheme: ".concat((String)object) : new String("Unsupported scheme: ");
                                throw new IOException((String)object);
                            }
                            object = String.valueOf(string2);
                            object = object.length() != 0 ? "Redirecting to ".concat((String)object) : new String("Redirecting to ");
                            he.b((String)object);
                            httpURLConnection.disconnect();
                            object = object2;
                            continue;
                        }
                        throw new IOException("Protocol is null");
                    }
                    throw new IOException("Missing Location header in redirect");
                }
                return httpURLConnection;
            }
            throw new IOException("Invalid protocol.");
        }
        throw new IOException("Too many redirects (20)");
    }
}

