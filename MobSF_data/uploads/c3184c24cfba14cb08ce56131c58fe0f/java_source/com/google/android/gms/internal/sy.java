/*
 * Decompiled with CFR 0_132.
 * 
 * Could not load the following classes:
 *  android.content.SharedPreferences
 *  android.content.SharedPreferences$Editor
 *  android.util.Pair
 */
package com.google.android.gms.internal;

import android.content.SharedPreferences;
import android.util.Pair;
import com.google.android.gms.common.internal.ah;
import com.google.android.gms.common.util.f;
import com.google.android.gms.internal.sw;
import com.google.android.gms.internal.sx;
import java.util.UUID;

public final class sy {
    private final String a;
    private final long b;
    private /* synthetic */ sw c;

    private sy(sw sw2, String string2, long l2) {
        this.c = sw2;
        ah.a(string2);
        boolean bl2 = l2 > 0L;
        ah.b(bl2);
        this.a = string2;
        this.b = l2;
    }

    /* synthetic */ sy(sw sw2, String string2, long l2, sx sx2) {
        this(sw2, string2, l2);
    }

    private final void b() {
        long l2 = this.c.h().a();
        SharedPreferences.Editor editor = sw.a(this.c).edit();
        editor.remove(this.e());
        editor.remove(this.f());
        editor.putLong(this.d(), l2);
        editor.commit();
    }

    private final long c() {
        return sw.a(this.c).getLong(this.d(), 0L);
    }

    private final String d() {
        return String.valueOf(this.a).concat(":start");
    }

    private final String e() {
        return String.valueOf(this.a).concat(":count");
    }

    private final String f() {
        return String.valueOf(this.a).concat(":value");
    }

    public final Pair<String, Long> a() {
        long l2 = this.c();
        l2 = l2 == 0L ? 0L : Math.abs(l2 - this.c.h().a());
        if (l2 < this.b) {
            return null;
        }
        if (l2 > this.b << 1) {
            this.b();
            return null;
        }
        String string2 = sw.a(this.c).getString(this.f(), null);
        l2 = sw.a(this.c).getLong(this.e(), 0L);
        this.b();
        if (string2 != null) {
            if (l2 <= 0L) {
                return null;
            }
            return new Pair((Object)string2, (Object)l2);
        }
        return null;
    }

    /*
     * Enabled aggressive block sorting
     * Enabled unnecessary exception pruning
     * Enabled aggressive exception aggregation
     */
    public final void a(String string2) {
        if (this.c() == 0L) {
            this.b();
        }
        String string3 = string2;
        if (string2 == null) {
            string3 = "";
        }
        synchronized (this) {
            long l2 = sw.a(this.c).getLong(this.e(), 0L);
            if (l2 <= 0L) {
                string2 = sw.a(this.c).edit();
                string2.putString(this.f(), string3);
                string2.putLong(this.e(), 1L);
                string2.apply();
                return;
            }
            long l3 = UUID.randomUUID().getLeastSignificantBits();
            boolean bl2 = (l3 & Long.MAX_VALUE) < Long.MAX_VALUE / ++l2;
            string2 = sw.a(this.c).edit();
            if (bl2) {
                string2.putString(this.f(), string3);
            }
            string2.putLong(this.e(), l2);
            string2.apply();
            return;
        }
    }
}

