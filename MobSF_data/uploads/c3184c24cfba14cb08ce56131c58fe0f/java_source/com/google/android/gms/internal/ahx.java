/*
 * Decompiled with CFR 0_132.
 * 
 * Could not load the following classes:
 *  android.annotation.SuppressLint
 *  android.content.Context
 *  android.content.SharedPreferences
 *  android.content.SharedPreferences$Editor
 */
package com.google.android.gms.internal;

import android.annotation.SuppressLint;
import android.content.Context;
import android.content.SharedPreferences;
import com.google.android.gms.common.internal.ah;
import java.util.Random;

public final class ahx {
    private final Context a;
    private final Random b;
    private final String c;

    public ahx(Context context, String string2) {
        this(context, string2, new Random());
    }

    private ahx(Context context, String string2, Random random) {
        this.a = ah.a(context);
        this.c = ah.a(string2);
        this.b = random;
    }

    private final long a(long l2, long l3) {
        SharedPreferences sharedPreferences = this.g();
        long l4 = Math.max(0L, sharedPreferences.getLong("FORBIDDEN_COUNT", 0L));
        long l5 = Math.max(0L, sharedPreferences.getLong("SUCCESSFUL_COUNT", 0L));
        l3 = (long)((float)l4 / (float)(l4 + l5 + 1L) * (float)(l3 - l2));
        return (long)(this.b.nextFloat() * (float)(l2 + l3));
    }

    private final SharedPreferences g() {
        Context context = this.a;
        String string2 = String.valueOf("v5_gtmContainerRefreshPolicy_");
        String string3 = String.valueOf(this.c);
        string2 = string3.length() != 0 ? string2.concat(string3) : new String(string2);
        return context.getSharedPreferences(string2, 0);
    }

    public final long a() {
        return this.a(7200000L, 259200000L) + 43200000L;
    }

    public final long b() {
        return this.a(600000L, 86400000L) + 3600000L;
    }

    public final long c() {
        if (Math.max(0L, this.g().getLong("FORBIDDEN_COUNT", 0L)) == 0L) {
            return 0L;
        }
        return this.a(10000L, 600000L) + 10000L;
    }

    public final boolean d() {
        if (Math.max(0L, this.g().getLong("FORBIDDEN_COUNT", 0L)) > 0L) {
            return true;
        }
        return false;
    }

    @SuppressLint(value={"CommitPrefEdits"})
    public final void e() {
        SharedPreferences sharedPreferences = this.g();
        long l2 = sharedPreferences.getLong("FORBIDDEN_COUNT", 0L);
        long l3 = sharedPreferences.getLong("SUCCESSFUL_COUNT", 0L);
        sharedPreferences = sharedPreferences.edit();
        l2 = l2 == 0L ? 3L : Math.min(10L, l2 + 1L);
        l3 = Math.max(0L, Math.min(l3, 10L - l2));
        sharedPreferences.putLong("FORBIDDEN_COUNT", l2);
        sharedPreferences.putLong("SUCCESSFUL_COUNT", l3);
        sharedPreferences.apply();
    }

    @SuppressLint(value={"CommitPrefEdits"})
    public final void f() {
        SharedPreferences sharedPreferences = this.g();
        long l2 = sharedPreferences.getLong("SUCCESSFUL_COUNT", 0L);
        long l3 = sharedPreferences.getLong("FORBIDDEN_COUNT", 0L);
        l2 = Math.min(10L, l2 + 1L);
        l3 = Math.max(0L, Math.min(l3, 10L - l2));
        sharedPreferences = sharedPreferences.edit();
        sharedPreferences.putLong("SUCCESSFUL_COUNT", l2);
        sharedPreferences.putLong("FORBIDDEN_COUNT", l3);
        sharedPreferences.apply();
    }
}

